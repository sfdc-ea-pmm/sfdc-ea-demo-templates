{
  "name" : "Promotion_Revenue_PMM_Tech_Promotion_Uplift",
  "label" : "Promotion Revenue PMM Tech Promotion Uplift",
  "scheduleExpression" : null,
  "publishingTarget" : "DATASET",
  "format" : "R3",
  "scheduleType" : null,
  "recipeDefinition" : {
    "version" : "53.0",
    "nodes" : {
      "LOAD_DATASET4" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "IsDeleted",
            "LoyaltyProgramMemberId",
            "LoyaltyProgramCurrencyId",
            "TransactionJournalId",
            "ActivityDate",
            "EventType",
            "Points",
            "PromotionId"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "LoyaltyLedger",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "LoyaltyLedger"
          }
        }
      },
      "LOAD_DATASET5" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "MemberId",
            "JournalTypeId",
            "JournalSubTypeId",
            "ActivityDate",
            "JournalDate",
            "Status",
            "UsageType",
            "StartDate",
            "TransactionAmount",
            "PaymentMethod",
            "PartnerId",
            "Quantity",
            "ProductId",
            "ProductCategoryId",
            "Industry",
            "ReferredMemberId",
            "RelatedJournalId",
            "LoyaltyProgramId"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "TransactionJournal",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "TransactionJournal"
          }
        }
      },
      "LOAD_DATASET6" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "JournalType",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "JournalType"
          }
        }
      },
      "JOIN5" : {
        "action" : "join",
        "sources" : [
          "LOAD_DATASET5",
          "LOAD_DATASET6"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [ ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "JournalTypeId"
          ],
          "rightQualifier" : "JournalType",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "FILTER0" : {
        "action" : "filter",
        "sources" : [
          "JOIN5"
        ],
        "parameters" : {
          "filterExpressions" : [
            {
              "type" : "TEXT",
              "field" : "Status",
              "operator" : "EQUAL",
              "operands" : [
                "Processed"
              ]
            },
            {
              "type" : "TEXT",
              "field" : "JournalType.Name",
              "operator" : "EQUAL",
              "operands" : [
                "Accrual",
                "Points Expiration",
                "Redemption"
              ]
            }
          ]
        }
      },
      "FORMULA2" : {
        "action" : "formula",
        "sources" : [
          "FILTER0"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula",
              "label" : "ActivityDate_Flag",
              "formulaExpression" : "case when months_between(now(),ActivityDate) > 1 and months_between(now(), ActivityDate) <= 7+18 then 'Current' when months_between(now(),ActivityDate) > 7+18 and months_between(now(), ActivityDate) <= 13+36 then 'Previous' else 'Others' end",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES0" : {
        "action" : "schema",
        "sources" : [
          "FORMULA2"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "ActivityDate_Flag",
                "name" : "ActivityDate_Flag",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "FORMULA3" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES0"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula1",
              "label" : "Accrual_Transactions_Current_Period",
              "formulaExpression" : "case when \"JournalType.Name\" = 'Accrual' and Status = 'Processed' and ActivityDate_Flag = 'Others' then 1 else 0 end",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES1" : {
        "action" : "schema",
        "sources" : [
          "FORMULA3"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula1",
              "newProperties" : {
                "label" : "Accrual_Transactions_Current_Period",
                "name" : "Accrual_Transactions_Current_Period",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA4" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES1"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Transaction_Amount_Current_Period",
              "formulaExpression" : "case when (\"JournalType.Name\" = 'Accrual' or \"JournalType.Name\" = 'Redemption') and Status = 'Processed' and ActivityDate_Flag = 'Current' then TransactionAmount else 0 end",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES2" : {
        "action" : "schema",
        "sources" : [
          "FORMULA4"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Transaction_Amount_Current_Period",
                "name" : "Transaction_Amount_Current_Period",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA5" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES2"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Transactions_all",
              "formulaExpression" : "case when \"JournalType.Name\" = 'Accrual' and Status = 'Processed' then 1 else 0 end",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES3" : {
        "action" : "schema",
        "sources" : [
          "FORMULA5"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Transactions_all",
                "name" : "Transactions_all",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA6" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES3"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Transaction_Amount_all",
              "formulaExpression" : "case when (\"JournalType.Name\" = 'Accrual' or \"JournalType.Name\" = 'Redemption') and Status = 'Processed' then TransactionAmount else 0 end",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES4" : {
        "action" : "schema",
        "sources" : [
          "FORMULA43"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Transaction_Amount_all",
                "name" : "Transaction_Amount_all",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA7" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES4"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "DATETIME",
              "name" : "Id_formula",
              "label" : "Current_ActivityDate",
              "formulaExpression" : "case when ActivityDate_Flag = 'Current' then ActivityDate end",
              "format" : "yyyy-MM-dd'T'HH:mm:ss.SSS'Z'",
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES5" : {
        "action" : "schema",
        "sources" : [
          "FORMULA7"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Current_ActivityDate",
                "name" : "Current_ActivityDate",
                "typeProperties" : {
                  "type" : "DATETIME",
                  "format" : "yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"
                }
              }
            }
          ]
        }
      },
      "FORMULA8" : {
        "action" : "computeRelative",
        "sources" : [
          "EDIT_ATTRIBUTES5"
        ],
        "parameters" : {
          "partitionBy" : [
            "MemberId"
          ],
          "orderBy" : [
            {
              "fieldName" : "Current_ActivityDate",
              "direction" : "DESC"
            }
          ],
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "DaysBetweenCurrentTransactions",
              "formulaExpression" : "datediff(current(Current_ActivityDate), lag(Current_ActivityDate))",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : "0"
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES7" : {
        "action" : "schema",
        "sources" : [
          "FORMULA8"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "DaysBetweenCurrentTransactions",
                "name" : "DaysBetweenCurrentTransactions",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA9" : {
        "action" : "computeRelative",
        "sources" : [
          "EDIT_ATTRIBUTES48"
        ],
        "parameters" : {
          "partitionBy" : [
            "MemberId"
          ],
          "orderBy" : [
            {
              "fieldName" : "ActivityDate",
              "direction" : "DESC"
            }
          ],
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "DATETIME",
              "name" : "Id_formula1",
              "label" : "Last_Transaction_Activity_Date",
              "formulaExpression" : "first_value(ActivityDate)",
              "format" : "yyyy-MM-dd'T'HH:mm:ss.SSS'Z'",
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES6" : {
        "action" : "schema",
        "sources" : [
          "FORMULA9"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula1",
              "newProperties" : {
                "label" : "Last_Transaction_Activity_Date",
                "name" : "Last_Transaction_Activity_Date",
                "typeProperties" : {
                  "type" : "DATETIME",
                  "format" : "yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"
                }
              }
            }
          ]
        }
      },
      "FORMULA14" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES6"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Transaction_Count",
              "formulaExpression" : "1",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES13" : {
        "action" : "schema",
        "sources" : [
          "FORMULA14"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Transaction_Count",
                "name" : "Transaction_Count",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA43" : {
        "action" : "formula",
        "sources" : [
          "FORMULA6"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula_formula",
              "label" : "Accrual_Transaction_Amount",
              "formulaExpression" : "case when \"JournalType.Name\" = 'Accrual' and Status = 'Processed' then TransactionAmount else 0 end",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES48" : {
        "action" : "schema",
        "sources" : [
          "EDIT_ATTRIBUTES7"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula_formula",
              "newProperties" : {
                "label" : "Accrual_Transaction_Amount",
                "name" : "Accrual_Transaction_Amount",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "JOIN7" : {
        "action" : "join",
        "sources" : [
          "LOAD_DATASET4",
          "EDIT_ATTRIBUTES13"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [ ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "TransactionJournalId"
          ],
          "rightQualifier" : "Journal",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "FORMULA10" : {
        "action" : "formula",
        "sources" : [
          "JOIN7"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula",
              "label" : "ActivityDate_Flag",
              "formulaExpression" : "case when months_between(now(),ActivityDate) > 1 and months_between(now(), ActivityDate) <= 7+18 then 'Current' when months_between(now(),ActivityDate) > 7+18 and months_between(now(), ActivityDate) <= 13+36 then 'Previous' else 'Others' end",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES9" : {
        "action" : "schema",
        "sources" : [
          "FORMULA10"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "ActivityDate_Flag",
                "name" : "ActivityDate_Flag",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "FORMULA11" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES9"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula",
              "label" : "TransactionType",
              "formulaExpression" : "case \nwhen \"Journal.Status\" = 'Processed' and EventType = 'Credit' then \ncase \nwhen \"Journal.JournalType.Name\" = 'Accrual' then 'Accrual'\nwhen \"Journal.JournalType.Name\" = 'Manual Points Adjustment' then 'AdjustedPoints_Positive'\nwhen \"Journal.JournalType.Name\" = 'Redemption Reversal' then 'RedemptionReversal' end \nwhen \"Journal.Status\" = 'Processed' and EventType = 'Debit' then\ncase\nwhen \"Journal.JournalType.Name\" = 'Redemption' then 'Redemption'\nwhen \"Journal.JournalType.Name\" = 'Manual Points Adjustment' \nthen 'AdjustedPoints_Negative'\nwhen \"Journal.JournalType.Name\" = 'Accrual Reversal' then 'AccrualReversal'\nend \nwhen \"Journal.Status\" = 'Processed' and EventType = 'Expiry' then 'Expired' end",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES10" : {
        "action" : "schema",
        "sources" : [
          "FORMULA11"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "TransactionType",
                "name" : "TransactionType",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "FORMULA12" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES10"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Current_Accrued_Points",
              "formulaExpression" : "case\nwhen (TransactionType = 'Accrual' or TransactionType = 'AdjustedPoints_Positive') and ActivityDate_Flag = 'Current' then Points\nwhen TransactionType = 'AdjustedPoints_Negative' then -1*Points\nelse 0 end",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES11" : {
        "action" : "schema",
        "sources" : [
          "FORMULA12"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Current_Accrued_Points",
                "name" : "Current_Accrued_Points",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA13" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES11"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Current_Expired_Points",
              "formulaExpression" : "case\nwhen EventType = 'Expiry' and ActivityDate_Flag = 'Current' then Points\nelse 0 end",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES12" : {
        "action" : "schema",
        "sources" : [
          "FORMULA13"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Current_Expired_Points",
                "name" : "Current_Expired_Points",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA47" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES12"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Promotion_Revenue",
              "formulaExpression" : "case when PromotionId is not null then \"Journal.Accrual_Transaction_Amount\" else 0 end",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES52" : {
        "action" : "schema",
        "sources" : [
          "FORMULA47"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Promotion_Revenue",
                "name" : "Promotion_Revenue",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "LOAD_DATASET8" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "MembershipNumber",
            "ProgramId",
            "MemberType",
            "ReferredById",
            "EnrollmentDate",
            "MemberStatus",
            "EnrollmentChannel",
            "AccountId",
            "ContactId"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "LoyaltyProgramMember",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "LoyaltyProgramMember"
          }
        }
      },
      "JOIN12" : {
        "action" : "join",
        "sources" : [
          "FILTER1",
          "EDIT_ATTRIBUTES52"
        ],
        "schema" : {
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "Ledger.ActivityDate",
              "Ledger.ActivityDate_Flag",
              "Ledger.EventType",
              "Ledger.Id",
              "Ledger.IsDeleted",
              "Ledger.Journal.ActivityDate",
              "Ledger.Journal.ActivityDate_Flag",
              "Ledger.Journal.Current_ActivityDate",
              "Ledger.Journal.Id",
              "Ledger.Journal.Industry",
              "Ledger.Journal.JournalDate",
              "Ledger.Journal.JournalSubTypeId",
              "Ledger.Journal.JournalType.Id",
              "Ledger.Journal.JournalType.Name",
              "Ledger.Journal.JournalTypeId",
              "Ledger.Journal.Last_Transaction_Activity_Date",
              "Ledger.Journal.LoyaltyProgramId",
              "Ledger.Journal.MemberId",
              "Ledger.Journal.PartnerId",
              "Ledger.Journal.PaymentMethod",
              "Ledger.Journal.ProductCategoryId",
              "Ledger.Journal.ProductId",
              "Ledger.Journal.Quantity",
              "Ledger.Journal.ReferredMemberId",
              "Ledger.Journal.RelatedJournalId",
              "Ledger.Journal.StartDate",
              "Ledger.Journal.Status",
              "Ledger.Journal.TransactionAmount",
              "Ledger.Journal.UsageType",
              "Ledger.LoyaltyProgramCurrencyId",
              "Ledger.LoyaltyProgramMemberId",
              "Ledger.PromotionId",
              "Ledger.TransactionJournalId",
              "Ledger.TransactionType"
            ]
          }
        },
        "parameters" : {
          "joinType" : "MULTI_VALUE_LOOKUP",
          "leftKeys" : [
            "ProgramCurrency.Id",
            "LoyaltyMemberId"
          ],
          "rightQualifier" : "Ledger",
          "rightKeys" : [
            "LoyaltyProgramCurrencyId",
            "LoyaltyProgramMemberId"
          ]
        }
      },
      "JOIN8" : {
        "action" : "join",
        "sources" : [
          "FILTER2",
          "JOIN12"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [ ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "ProgramId",
            "Id"
          ],
          "rightQualifier" : "MemberCurrency",
          "rightKeys" : [
            "ProgramCurrency.LoyaltyProgramId",
            "LoyaltyMemberId"
          ]
        }
      },
      "JOIN9" : {
        "action" : "join",
        "sources" : [
          "JOIN8",
          "EDIT_ATTRIBUTES13"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "Transaction.JournalTypeId",
              "Transaction.JournalSubTypeId",
              "Transaction.JournalDate",
              "Transaction.UsageType",
              "Transaction.Quantity",
              "Transaction.Industry",
              "Transaction.JournalType.Id"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "ProgramId",
            "Id"
          ],
          "rightQualifier" : "Transaction",
          "rightKeys" : [
            "LoyaltyProgramId",
            "MemberId"
          ]
        }
      },
      "JOIN10" : {
        "action" : "join",
        "sources" : [
          "JOIN9",
          "EDIT_ATTRIBUTES13"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "Journal.ActivityDate",
              "Journal.ActivityDate_Flag",
              "Journal.Current_ActivityDate",
              "Journal.Id",
              "Journal.Industry",
              "Journal.JournalDate",
              "Journal.JournalSubTypeId",
              "Journal.JournalType.Id",
              "Journal.JournalType.Name",
              "Journal.JournalTypeId",
              "Journal.Last_Transaction_Activity_Date",
              "Journal.LoyaltyProgramId",
              "Journal.MemberId",
              "Journal.PartnerId",
              "Journal.PaymentMethod",
              "Journal.ProductCategoryId",
              "Journal.ProductId",
              "Journal.Quantity",
              "Journal.ReferredMemberId",
              "Journal.RelatedJournalId",
              "Journal.StartDate",
              "Journal.Status",
              "Journal.TransactionAmount",
              "Journal.UsageType"
            ]
          }
        },
        "parameters" : {
          "joinType" : "MULTI_VALUE_LOOKUP",
          "leftKeys" : [
            "ProgramId",
            "Id"
          ],
          "rightQualifier" : "Journal",
          "rightKeys" : [
            "LoyaltyProgramId",
            "MemberId"
          ]
        }
      },
      "JOIN11" : {
        "action" : "join",
        "sources" : [
          "LOAD_DATASET9",
          "LOAD_DATASET10"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [ ]
          }
        },
        "parameters" : {
          "joinType" : "LEFT_OUTER",
          "leftKeys" : [
            "LoyaltyProgramCurrencyId"
          ],
          "rightQualifier" : "ProgramCurrency",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "LOAD_DATASET9" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name",
            "LoyaltyMemberId",
            "LoyaltyProgramCurrencyId",
            "PointsBalance"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "LoyaltyMemberCurrency",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "LoyaltyMemberCurrency"
          }
        }
      },
      "FILTER1" : {
        "action" : "filter",
        "sources" : [
          "JOIN11"
        ],
        "parameters" : {
          "filterExpressions" : [
            {
              "type" : "TEXT",
              "field" : "ProgramCurrency.Name",
              "operator" : "EQUAL",
              "operands" : [
                "Points"
              ]
            }
          ]
        }
      },
      "LOAD_DATASET10" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name",
            "LoyaltyProgramId",
            "CurrencyType",
            "LoyaltyTierGroupId",
            "IsActive"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "LoyaltyProgramCurrency",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "LoyaltyProgramCurrency"
          }
        }
      },
      "LOAD_DATASET11" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name",
            "Status"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "LoyaltyProgram",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "LoyaltyProgram"
          }
        }
      },
      "JOIN13" : {
        "action" : "join",
        "sources" : [
          "LOAD_DATASET8",
          "LOAD_DATASET11"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [ ]
          }
        },
        "parameters" : {
          "joinType" : "LEFT_OUTER",
          "leftKeys" : [
            "ProgramId"
          ],
          "rightQualifier" : "Program",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "JOIN14" : {
        "action" : "join",
        "sources" : [
          "LOAD_DATASET12",
          "EDIT_ATTRIBUTES13"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "Journal.Id",
              "Journal.MemberId",
              "Journal.JournalTypeId",
              "Journal.JournalSubTypeId",
              "Journal.ActivityDate",
              "Journal.JournalDate",
              "Journal.Status",
              "Journal.UsageType",
              "Journal.StartDate",
              "Journal.TransactionAmount",
              "Journal.PaymentMethod",
              "Journal.PartnerId",
              "Journal.Quantity",
              "Journal.ProductId",
              "Journal.ProductCategoryId",
              "Journal.Industry",
              "Journal.ReferredMemberId",
              "Journal.RelatedJournalId",
              "Journal.LoyaltyProgramId",
              "Journal.JournalType.Id",
              "Journal.JournalType.Name",
              "Journal.ActivityDate_Flag",
              "Journal.Current_ActivityDate",
              "Journal.Accrual_Transaction_Amount",
              "Journal.Last_Transaction_Activity_Date"
            ]
          }
        },
        "parameters" : {
          "joinType" : "MULTI_VALUE_LOOKUP",
          "leftKeys" : [
            "Id"
          ],
          "rightQualifier" : "Journal",
          "rightKeys" : [
            "PartnerId"
          ]
        }
      },
      "JOIN15" : {
        "action" : "join",
        "sources" : [
          "LOAD_DATASET13",
          "EDIT_ATTRIBUTES13"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "Journal.Id",
              "Journal.MemberId",
              "Journal.JournalTypeId",
              "Journal.JournalSubTypeId",
              "Journal.ActivityDate",
              "Journal.JournalDate",
              "Journal.Status",
              "Journal.UsageType",
              "Journal.StartDate",
              "Journal.TransactionAmount",
              "Journal.PaymentMethod",
              "Journal.PartnerId",
              "Journal.Quantity",
              "Journal.ProductId",
              "Journal.ProductCategoryId",
              "Journal.Industry",
              "Journal.ReferredMemberId",
              "Journal.RelatedJournalId",
              "Journal.LoyaltyProgramId",
              "Journal.JournalType.Id",
              "Journal.JournalType.Name",
              "Journal.ActivityDate_Flag",
              "Journal.Current_ActivityDate",
              "Journal.Accrual_Transaction_Amount",
              "Journal.Last_Transaction_Activity_Date"
            ]
          }
        },
        "parameters" : {
          "joinType" : "MULTI_VALUE_LOOKUP",
          "leftKeys" : [
            "Id"
          ],
          "rightQualifier" : "Journal",
          "rightKeys" : [
            "ProductId"
          ]
        }
      },
      "JOIN16" : {
        "action" : "join",
        "sources" : [
          "LOAD_DATASET14",
          "EDIT_ATTRIBUTES13"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "Journal.Id",
              "Journal.MemberId",
              "Journal.JournalTypeId",
              "Journal.JournalSubTypeId",
              "Journal.ActivityDate",
              "Journal.JournalDate",
              "Journal.Status",
              "Journal.UsageType",
              "Journal.StartDate",
              "Journal.TransactionAmount",
              "Journal.PaymentMethod",
              "Journal.PartnerId",
              "Journal.Quantity",
              "Journal.ProductId",
              "Journal.ProductCategoryId",
              "Journal.Industry",
              "Journal.ReferredMemberId",
              "Journal.RelatedJournalId",
              "Journal.LoyaltyProgramId",
              "Journal.JournalType.Id",
              "Journal.JournalType.Name",
              "Journal.ActivityDate_Flag",
              "Journal.Current_ActivityDate",
              "Journal.Accrual_Transaction_Amount",
              "Journal.Last_Transaction_Activity_Date"
            ]
          }
        },
        "parameters" : {
          "joinType" : "MULTI_VALUE_LOOKUP",
          "leftKeys" : [
            "Id"
          ],
          "rightQualifier" : "Journal",
          "rightKeys" : [
            "ProductCategoryId"
          ]
        }
      },
      "FILTER2" : {
        "action" : "filter",
        "sources" : [
          "JOIN13"
        ],
        "parameters" : {
          "filterExpressions" : [
            {
              "type" : "TEXT",
              "field" : "Program.Name",
              "operator" : "EQUAL",
              "operands" : [
                "NTO Insider"
              ]
            }
          ]
        }
      },
      "LOAD_DATASET12" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name",
            "LoyaltyPartnerId",
            "LoyaltyProgramId",
            "PartnerType"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "LoyaltyProgramPartner",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "LoyaltyProgramPartner"
          }
        }
      },
      "LOAD_DATASET13" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name",
            "ProductCode",
            "Family"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "Product2",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "Product2"
          }
        }
      },
      "LOAD_DATASET14" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "ProductCategory",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "ProductCategory"
          }
        }
      },
      "LOAD_DATASET17" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "LoyaltyProgram",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "LoyaltyProgram"
          }
        }
      },
      "JOIN17" : {
        "action" : "join",
        "sources" : [
          "JOIN57",
          "LOAD_DATASET17"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [ ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "LoyaltyProgramId"
          ],
          "rightQualifier" : "Program",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "FORMULA16" : {
        "action" : "formula",
        "sources" : [
          "JOIN17"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula",
              "label" : "StartDate_Flag",
              "formulaExpression" : "case \nwhen datediff(StartDate, now())>0 \nthen 'Future Promotions' \nwhen datediff(EndDate, now())<=0 and months_between(now(), EndDate) <= 24 \nthen 'Training Promotions' \nelse 'Past/Ongoing Promotions' \nend",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES15" : {
        "action" : "schema",
        "sources" : [
          "FORMULA16"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "StartDate_Flag",
                "name" : "StartDate_Flag",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "FILTER3" : {
        "action" : "filter",
        "sources" : [
          "EDIT_ATTRIBUTES15"
        ],
        "parameters" : {
          "filterExpressions" : [
            {
              "type" : "TEXT",
              "field" : "Program.Name",
              "operator" : "EQUAL",
              "operands" : [
                "NTO Insider"
              ]
            },
            {
              "type" : "TEXT",
              "field" : "StartDate_Flag",
              "operator" : "EQUAL",
              "operands" : [
                "Future Promotions"
              ]
            },
            {
              "type" : "TEXT",
              "field" : "FulfillmentAction",
              "operator" : "EQUAL",
              "operands" : [
                "CreditPoints"
              ]
            }
          ]
        }
      },
      "LOAD_DATASET15" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name",
            "StartDate",
            "EndDate",
            "FulfillmentAction",
            "LoyaltyProgramId",
            "LoyaltyProgramCurrencyId"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "Promotion",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "Promotion"
          }
        }
      },
      "LOAD_DATASET16" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "MembershipNumber",
            "ProgramId"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "LoyaltyProgramMember",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "LoyaltyProgramMember"
          }
        }
      },
      "JOIN18" : {
        "action" : "join",
        "sources" : [
          "FILTER3",
          "FILTER14"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [ ]
          }
        },
        "parameters" : {
          "joinType" : "LEFT_OUTER",
          "leftKeys" : [
            "Program.Id"
          ],
          "rightQualifier" : "Member",
          "rightKeys" : [
            "ProgramId"
          ]
        }
      },
      "LOAD_DATASET18" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name",
            "PromotionId",
            "LoyaltyPartnerProductId",
            "LoyaltyProductId",
            "LoyaltyPartnerId",
            "ProductCategoryId"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "PromotionLoyaltyPtnrProdt",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "PromotionLoyaltyPtnrProdt"
          }
        }
      },
      "FILTER4" : {
        "action" : "filter",
        "sources" : [
          "EDIT_ATTRIBUTES13"
        ],
        "parameters" : {
          "filterExpressions" : [
            {
              "type" : "TEXT",
              "field" : "ActivityDate_Flag",
              "operator" : "EQUAL",
              "operands" : [
                "Current"
              ]
            }
          ]
        }
      },
      "JOIN19" : {
        "action" : "join",
        "sources" : [
          "AGGREGATE1",
          "AGGREGATE3"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "UNIQUE_Id",
              "Member_Partner.PartnerId",
              "Member_Partner.UNIQUE_Id"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LEFT_OUTER",
          "leftKeys" : [
            "LoyaltyPartnerId"
          ],
          "rightQualifier" : "Member_Partner",
          "rightKeys" : [
            "PartnerId"
          ]
        }
      },
      "JOIN20" : {
        "action" : "join",
        "sources" : [
          "AGGREGATE7",
          "AGGREGATE9"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "Member_Product.UNIQUE_Id",
              "UNIQUE_Id"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LEFT_OUTER",
          "leftKeys" : [
            "Product_or_Prod_Category_ID"
          ],
          "rightQualifier" : "Member_Product",
          "rightKeys" : [
            "Product_or_Prod_Category_ID"
          ]
        }
      },
      "JOIN21" : {
        "action" : "join",
        "sources" : [
          "AGGREGATE13",
          "AGGREGATE15"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "UNIQUE_Id",
              "Member_ProductCategory.ProductCategoryId",
              "Member_ProductCategory.UNIQUE_Id"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LEFT_OUTER",
          "leftKeys" : [
            "ProductCategoryId"
          ],
          "rightQualifier" : "Member_ProductCategory",
          "rightKeys" : [
            "ProductCategoryId"
          ]
        }
      },
      "FORMULA17" : {
        "action" : "formula",
        "sources" : [
          "JOIN19"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Count",
              "formulaExpression" : "case when \"Member_Partner.MemberId\" is not null then 1 else 0 end",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : "1"
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES16" : {
        "action" : "schema",
        "sources" : [
          "FORMULA17"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Count",
                "name" : "Count",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA27" : {
        "action" : "formula",
        "sources" : [
          "JOIN20"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "PromotionId_formula",
              "label" : "Count",
              "formulaExpression" : "case when \"Member_Product.MemberId\" is not null then 1 else 0 end",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES26" : {
        "action" : "schema",
        "sources" : [
          "FORMULA27"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "PromotionId_formula",
              "newProperties" : {
                "label" : "Count",
                "name" : "Count",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA19" : {
        "action" : "formula",
        "sources" : [
          "JOIN21"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Count",
              "formulaExpression" : "case when \"Member_ProductCategory.MemberId\" is not null then 1 else 0 end",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : "1"
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES17" : {
        "action" : "schema",
        "sources" : [
          "FORMULA19"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Count",
                "name" : "Count",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "JOIN22" : {
        "action" : "join",
        "sources" : [
          "JOIN49",
          "EDIT_ATTRIBUTES65"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [ ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Member.Id"
          ],
          "rightQualifier" : "Members",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "FORMULA20" : {
        "action" : "formula",
        "sources" : [
          "JOIN14"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Partner_Count",
              "formulaExpression" : "1",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES19" : {
        "action" : "schema",
        "sources" : [
          "FORMULA20"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Partner_Count",
                "name" : "Partner_Count",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA21" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES19"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Avg_Transaction_Amount",
              "formulaExpression" : "coalesce(\"Journal.Transaction_Amount_all\"/\"Journal.Transactions_all\" , 0)",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES20" : {
        "action" : "schema",
        "sources" : [
          "FORMULA21"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Avg_Transaction_Amount",
                "name" : "Avg_Transaction_Amount",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA22" : {
        "action" : "formula",
        "sources" : [
          "JOIN15"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Product_Count",
              "formulaExpression" : "1",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES21" : {
        "action" : "schema",
        "sources" : [
          "FORMULA22"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Product_Count",
                "name" : "Product_Count",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA23" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES21"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Avg_Transaction_Amount",
              "formulaExpression" : "coalesce(\"Journal.Transaction_Amount_all\"/\"Journal.Transactions_all\" , 0)",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES22" : {
        "action" : "schema",
        "sources" : [
          "FORMULA23"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Avg_Transaction_Amount",
                "name" : "Avg_Transaction_Amount",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA24" : {
        "action" : "formula",
        "sources" : [
          "JOIN16"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "ProductCategory_Count",
              "formulaExpression" : "1",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES23" : {
        "action" : "schema",
        "sources" : [
          "FORMULA24"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "ProductCategory_Count",
                "name" : "ProductCategory_Count",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA25" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES23"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Avg_Transaction_Amount",
              "formulaExpression" : "coalesce(\"Journal.Transaction_Amount_all\"/\"Journal.Transactions_all\" , 0)",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES24" : {
        "action" : "schema",
        "sources" : [
          "FORMULA25"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Avg_Transaction_Amount",
                "name" : "Avg_Transaction_Amount",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "LOAD_DATASET19" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Loyalty_Program",
            "Membership_Number",
            "Promotion_Id"
          ],
          "dataset" : {
            "type" : "analyticsDataset",
            "label" : "Members_Targeted_v3_3_Members_Targeted_v3_3",
            "name" : "\\${App.Datasets.${App.Datasets[Rules.CurrentNode].Name}.FullyQualifiedName}"
          }
        }
      },
      "LOAD_DATASET20" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Loyalty_Program",
            "Hobby",
            "Membership_Number",
            "Market_Segment_1",
            "Market_Segment_2"
          ],
          "dataset" : {
            "type" : "analyticsDataset",
            "label" : "Member_Details_Demo_Org",
            "name" : "\\${App.Datasets.${App.Datasets[Rules.CurrentNode].Name}.FullyQualifiedName}"
          }
        }
      },
      "JOIN23" : {
        "action" : "join",
        "sources" : [
          "FILTER15",
          "LOAD_DATASET20"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [ ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Membership_Number"
          ],
          "rightQualifier" : "Member_Segment",
          "rightKeys" : [
            "Membership_Number"
          ]
        }
      },
      "LOAD_DATASET21" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "MembershipNumber",
            "ProgramId"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "LoyaltyProgramMember",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "LoyaltyProgramMember"
          }
        }
      },
      "JOIN24" : {
        "action" : "join",
        "sources" : [
          "FILTER13",
          "LOAD_DATASET21"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [ ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Membership_Number"
          ],
          "rightQualifier" : "ProgramMember",
          "rightKeys" : [
            "MembershipNumber"
          ]
        }
      },
      "JOIN25" : {
        "action" : "join",
        "sources" : [
          "JOIN50",
          "EDIT_ATTRIBUTES65"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [ ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "ProgramMember.Id"
          ],
          "rightQualifier" : "Members",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "LOAD_DATASET22" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name",
            "PromotionId",
            "LoyaltyPartnerProductId",
            "LoyaltyProductId",
            "LoyaltyPartnerId",
            "ProductCategoryId"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "PromotionLoyaltyPtnrProdt",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "PromotionLoyaltyPtnrProdt"
          }
        }
      },
      "EXTRACT0" : {
        "action" : "extractGrains",
        "sources" : [
          "LOAD_DATASET18"
        ],
        "parameters" : {
          "grainExtractions" : [ ]
        }
      },
      "AGGREGATE1" : {
        "action" : "aggregate",
        "sources" : [
          "EXTRACT0"
        ],
        "parameters" : {
          "aggregations" : [
            {
              "action" : "UNIQUE",
              "source" : "Id",
              "name" : "UNIQUE_Id",
              "label" : "Unique Promotion Loyalty Partner Product ID"
            }
          ],
          "groupings" : [
            "PromotionId",
            "LoyaltyPartnerId"
          ],
          "pivots" : [ ],
          "nodeType" : "STANDARD"
        }
      },
      "EXTRACT1" : {
        "action" : "extractGrains",
        "sources" : [
          "FILTER4"
        ],
        "parameters" : {
          "grainExtractions" : [ ]
        }
      },
      "AGGREGATE3" : {
        "action" : "aggregate",
        "sources" : [
          "EXTRACT1"
        ],
        "parameters" : {
          "aggregations" : [
            {
              "action" : "UNIQUE",
              "source" : "Id",
              "name" : "UNIQUE_Id",
              "label" : "Unique Transaction Journal ID"
            }
          ],
          "groupings" : [
            "MemberId",
            "PartnerId"
          ],
          "pivots" : [ ],
          "nodeType" : "STANDARD"
        }
      },
      "EXTRACT2" : {
        "action" : "extractGrains",
        "sources" : [
          "EDIT_ATTRIBUTES16"
        ],
        "parameters" : {
          "grainExtractions" : [ ]
        }
      },
      "AGGREGATE5" : {
        "action" : "aggregate",
        "sources" : [
          "EXTRACT2"
        ],
        "parameters" : {
          "aggregations" : [
            {
              "action" : "SUM",
              "source" : "Count",
              "name" : "SUM_Count",
              "label" : "Sum of Count"
            },
            {
              "action" : "UNIQUE",
              "source" : "LoyaltyPartnerId",
              "name" : "UNIQUE_LoyaltyPartnerId",
              "label" : "Unique Loyalty Program Partner ID"
            }
          ],
          "groupings" : [
            "PromotionId",
            "Member_Partner.MemberId"
          ],
          "pivots" : [ ],
          "nodeType" : "STANDARD"
        }
      },
      "FORMULA26" : {
        "action" : "formula",
        "sources" : [
          "AGGREGATE5"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "PromotionId_formula",
              "label" : "Partner_Overlap",
              "formulaExpression" : "case \nwhen coalesce((SUM_Count*100)/UNIQUE_LoyaltyPartnerId, 0) <= 0.33 then 'Low'\nwhen (coalesce((SUM_Count*100)/UNIQUE_LoyaltyPartnerId, 0) > 0.33 and coalesce((SUM_Count*100)/UNIQUE_LoyaltyPartnerId, 0) <= 0.66) then 'Medium'\nwhen coalesce((SUM_Count*100)/UNIQUE_LoyaltyPartnerId, 0) > 0.66  then 'High'\nend ",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES58" : {
        "action" : "schema",
        "sources" : [
          "FORMULA26"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "PromotionId_formula",
              "newProperties" : {
                "label" : "Partner_Overlap",
                "name" : "Partner_Overlap",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "EXTRACT3" : {
        "action" : "extractGrains",
        "sources" : [
          "EDIT_ATTRIBUTES62"
        ],
        "parameters" : {
          "grainExtractions" : [ ]
        }
      },
      "AGGREGATE7" : {
        "action" : "aggregate",
        "sources" : [
          "EXTRACT3"
        ],
        "parameters" : {
          "aggregations" : [
            {
              "action" : "UNIQUE",
              "source" : "Id",
              "name" : "UNIQUE_Id",
              "label" : "Unique Promotion Loyalty Partner Product ID"
            }
          ],
          "groupings" : [
            "PromotionId",
            "Product_or_Prod_Category_ID"
          ],
          "pivots" : [ ],
          "nodeType" : "STANDARD"
        }
      },
      "EXTRACT4" : {
        "action" : "extractGrains",
        "sources" : [
          "EDIT_ATTRIBUTES61"
        ],
        "parameters" : {
          "grainExtractions" : [ ]
        }
      },
      "AGGREGATE9" : {
        "action" : "aggregate",
        "sources" : [
          "EXTRACT4"
        ],
        "parameters" : {
          "aggregations" : [
            {
              "action" : "UNIQUE",
              "source" : "Id",
              "name" : "UNIQUE_Id",
              "label" : "Unique Transaction Journal ID"
            }
          ],
          "groupings" : [
            "MemberId",
            "Product_or_Prod_Category_ID"
          ],
          "pivots" : [ ],
          "nodeType" : "STANDARD"
        }
      },
      "EXTRACT5" : {
        "action" : "extractGrains",
        "sources" : [
          "EDIT_ATTRIBUTES26"
        ],
        "parameters" : {
          "grainExtractions" : [ ]
        }
      },
      "AGGREGATE11" : {
        "action" : "aggregate",
        "sources" : [
          "EXTRACT5"
        ],
        "parameters" : {
          "aggregations" : [
            {
              "action" : "SUM",
              "source" : "Count",
              "name" : "SUM_Count",
              "label" : "Sum of Count"
            },
            {
              "action" : "UNIQUE",
              "source" : "Product_or_Prod_Category_ID",
              "name" : "UNIQUE_Product_or_Prod_Category_ID",
              "label" : "Unique Product_or_Prod_Category_ID"
            }
          ],
          "groupings" : [
            "PromotionId",
            "Member_Product.MemberId"
          ],
          "pivots" : [ ],
          "nodeType" : "STANDARD"
        }
      },
      "FORMULA28" : {
        "action" : "formula",
        "sources" : [
          "AGGREGATE11"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "PromotionId_formula",
              "label" : "Product_Overlap",
              "formulaExpression" : "case \nwhen coalesce((SUM_Count*100)/UNIQUE_Product_or_Prod_Category_ID, 0) <= 0.33 then 'Low'\nwhen (coalesce((SUM_Count*100)/UNIQUE_Product_or_Prod_Category_ID, 0) > 0.33 and coalesce((SUM_Count*100)/UNIQUE_Product_or_Prod_Category_ID, 0) <= 0.66) then 'Medium'\nwhen coalesce((SUM_Count*100)/UNIQUE_Product_or_Prod_Category_ID, 0) > 0.66 then 'High'\nend",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES60" : {
        "action" : "schema",
        "sources" : [
          "FORMULA28"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "PromotionId_formula",
              "newProperties" : {
                "label" : "Product_Overlap",
                "name" : "Product_Overlap",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "EXTRACT6" : {
        "action" : "extractGrains",
        "sources" : [
          "LOAD_DATASET18"
        ],
        "parameters" : {
          "grainExtractions" : [ ]
        }
      },
      "AGGREGATE13" : {
        "action" : "aggregate",
        "sources" : [
          "EXTRACT6"
        ],
        "parameters" : {
          "aggregations" : [
            {
              "action" : "UNIQUE",
              "source" : "Id",
              "name" : "UNIQUE_Id",
              "label" : "Unique Promotion Loyalty Partner Product ID"
            }
          ],
          "groupings" : [
            "PromotionId",
            "ProductCategoryId"
          ],
          "pivots" : [ ],
          "nodeType" : "STANDARD"
        }
      },
      "EXTRACT7" : {
        "action" : "extractGrains",
        "sources" : [
          "FILTER4"
        ],
        "parameters" : {
          "grainExtractions" : [ ]
        }
      },
      "AGGREGATE15" : {
        "action" : "aggregate",
        "sources" : [
          "EXTRACT7"
        ],
        "parameters" : {
          "aggregations" : [
            {
              "action" : "UNIQUE",
              "source" : "Id",
              "name" : "UNIQUE_Id",
              "label" : "Unique Transaction Journal ID"
            }
          ],
          "groupings" : [
            "MemberId",
            "ProductCategoryId"
          ],
          "pivots" : [ ],
          "nodeType" : "STANDARD"
        }
      },
      "EXTRACT8" : {
        "action" : "extractGrains",
        "sources" : [
          "EDIT_ATTRIBUTES17"
        ],
        "parameters" : {
          "grainExtractions" : [ ]
        }
      },
      "AGGREGATE17" : {
        "action" : "aggregate",
        "sources" : [
          "EXTRACT8"
        ],
        "parameters" : {
          "aggregations" : [
            {
              "action" : "SUM",
              "source" : "Count",
              "name" : "SUM_Count",
              "label" : "Sum of Count"
            },
            {
              "action" : "UNIQUE",
              "source" : "ProductCategoryId",
              "name" : "UNIQUE_ProductCategoryId",
              "label" : "Unique Category ID"
            }
          ],
          "groupings" : [
            "PromotionId",
            "Member_ProductCategory.MemberId"
          ],
          "pivots" : [ ],
          "nodeType" : "STANDARD"
        }
      },
      "FORMULA29" : {
        "action" : "formula",
        "sources" : [
          "AGGREGATE17"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "PromotionId_formula",
              "label" : "ProductCategory_Overlap",
              "formulaExpression" : "case \nwhen coalesce((SUM_Count*100)/UNIQUE_ProductCategoryId, 0) <= 0.33 then 'Low'\nwhen (coalesce((SUM_Count*100)/UNIQUE_ProductCategoryId, 0) > 0.33 and coalesce((SUM_Count*100)/UNIQUE_ProductCategoryId, 0) <= 0.66) then 'Medium'\nwhen coalesce((SUM_Count*100)/UNIQUE_ProductCategoryId, 0) > 0.66 then 'High'\nend",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES59" : {
        "action" : "schema",
        "sources" : [
          "FORMULA29"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "PromotionId_formula",
              "newProperties" : {
                "label" : "ProductCategory_Overlap",
                "name" : "ProductCategory_Overlap",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "JOIN29" : {
        "action" : "join",
        "sources" : [
          "JOIN35",
          "EDIT_ATTRIBUTES58"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "Partner_Overlap.Member_Partner.MemberId",
              "Partner_Overlap.PromotionId",
              "Partner_Overlap.SUM_Count",
              "Partner_Overlap.UNIQUE_LoyaltyPartnerId"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Member.Id",
            "Id"
          ],
          "rightQualifier" : "Partner_Overlap",
          "rightKeys" : [
            "Member_Partner.MemberId",
            "PromotionId"
          ]
        }
      },
      "JOIN30" : {
        "action" : "join",
        "sources" : [
          "JOIN29",
          "EDIT_ATTRIBUTES60"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "Product_Overlap.PromotionId",
              "Product_Overlap.Member_Product.MemberId",
              "Product_Overlap.SUM_Count"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Id",
            "Member.Id"
          ],
          "rightQualifier" : "Product_Overlap",
          "rightKeys" : [
            "PromotionId",
            "Member_Product.MemberId"
          ]
        }
      },
      "JOIN31" : {
        "action" : "join",
        "sources" : [
          "JOIN30",
          "EDIT_ATTRIBUTES59"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "ProductCategory_Overlap.Member_ProductCategory.MemberId",
              "ProductCategory_Overlap.PromotionId",
              "ProductCategory_Overlap.SUM_Count",
              "ProductCategory_Overlap.UNIQUE_ProductCategoryId"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Id",
            "Member.Id"
          ],
          "rightQualifier" : "ProductCategory_Overlap",
          "rightKeys" : [
            "PromotionId",
            "Member_ProductCategory.MemberId"
          ]
        }
      },
      "JOIN32" : {
        "action" : "join",
        "sources" : [
          "JOIN24",
          "EDIT_ATTRIBUTES58"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "Partner_Overlap.Member_Partner.MemberId",
              "Partner_Overlap.PromotionId",
              "Partner_Overlap.SUM_Count",
              "Partner_Overlap.UNIQUE_LoyaltyPartnerId"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "ProgramMember.Id",
            "Promo.Id"
          ],
          "rightQualifier" : "Partner_Overlap",
          "rightKeys" : [
            "Member_Partner.MemberId",
            "PromotionId"
          ]
        }
      },
      "JOIN33" : {
        "action" : "join",
        "sources" : [
          "JOIN32",
          "EDIT_ATTRIBUTES60"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "Product_Overlap.Member_Product.MemberId",
              "Product_Overlap.PromotionId",
              "Product_Overlap.SUM_Count"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Promo.Id",
            "ProgramMember.Id"
          ],
          "rightQualifier" : "Product_Overlap",
          "rightKeys" : [
            "PromotionId",
            "Member_Product.MemberId"
          ]
        }
      },
      "JOIN34" : {
        "action" : "join",
        "sources" : [
          "JOIN33",
          "EDIT_ATTRIBUTES59"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [ ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Promo.Id",
            "ProgramMember.Id"
          ],
          "rightQualifier" : "ProductCategory_Overlap",
          "rightKeys" : [
            "PromotionId",
            "Member_ProductCategory.MemberId"
          ]
        }
      },
      "JOIN35" : {
        "action" : "join",
        "sources" : [
          "JOIN18",
          "LOAD_DATASET20"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [ ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Member.MembershipNumber"
          ],
          "rightQualifier" : "Member_Segment",
          "rightKeys" : [
            "Membership_Number"
          ]
        }
      },
      "EXTRACT9" : {
        "action" : "extractGrains",
        "sources" : [
          "LOAD_DATASET22"
        ],
        "parameters" : {
          "grainExtractions" : [ ]
        }
      },
      "AGGREGATE19" : {
        "action" : "aggregate",
        "sources" : [
          "EXTRACT9"
        ],
        "parameters" : {
          "aggregations" : [
            {
              "action" : "UNIQUE",
              "source" : "LoyaltyPartnerId",
              "name" : "UNIQUE_LoyaltyPartnerId",
              "label" : "Unique Loyalty Program Partner ID"
            }
          ],
          "groupings" : [
            "PromotionId",
            "LoyaltyPartnerId"
          ],
          "pivots" : [ ],
          "nodeType" : "STANDARD"
        }
      },
      "JOIN36" : {
        "action" : "join",
        "sources" : [
          "AGGREGATE19",
          "EDIT_ATTRIBUTES20"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "AllPartners.Id",
              "AllPartners.Name",
              "AllPartners.LoyaltyPartnerId",
              "AllPartners.LoyaltyProgramId",
              "AllPartners.PartnerType",
              "AllPartners.Journal.Accrual_Transactions_Current_Period",
              "AllPartners.Journal.Transaction_Amount_Current_Period",
              "AllPartners.Journal.Transactions_all",
              "AllPartners.Journal.Transaction_Amount_all",
              "AllPartners.Journal.DaysBetweenCurrentTransactions",
              "AllPartners.Journal.Transaction_Count",
              "AllPartners.Partner_Count"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "LoyaltyPartnerId"
          ],
          "rightQualifier" : "AllPartners",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "EXTRACT10" : {
        "action" : "extractGrains",
        "sources" : [
          "JOIN36"
        ],
        "parameters" : {
          "grainExtractions" : [ ]
        }
      },
      "AGGREGATE21" : {
        "action" : "aggregate",
        "sources" : [
          "EXTRACT10"
        ],
        "parameters" : {
          "aggregations" : [
            {
              "action" : "SUM",
              "source" : "AllPartners.Avg_Transaction_Amount",
              "name" : "SUM_AllPartners.Avg_Transaction_Amount",
              "label" : "Sum of Avg_Transaction_Amount"
            },
            {
              "action" : "UNIQUE",
              "source" : "LoyaltyPartnerId",
              "name" : "UNIQUE_LoyaltyPartnerId1",
              "label" : "Unique Loyalty Program Partner ID"
            }
          ],
          "groupings" : [
            "PromotionId"
          ],
          "pivots" : [ ],
          "nodeType" : "STANDARD"
        }
      },
      "EXTRACT11" : {
        "action" : "extractGrains",
        "sources" : [
          "LOAD_DATASET22"
        ],
        "parameters" : {
          "grainExtractions" : [ ]
        }
      },
      "AGGREGATE23" : {
        "action" : "aggregate",
        "sources" : [
          "EXTRACT11"
        ],
        "parameters" : {
          "aggregations" : [
            {
              "action" : "UNIQUE",
              "source" : "LoyaltyProductId",
              "name" : "UNIQUE_LoyaltyProductId",
              "label" : "Unique Product ID"
            }
          ],
          "groupings" : [
            "PromotionId",
            "LoyaltyProductId"
          ],
          "pivots" : [ ],
          "nodeType" : "STANDARD"
        }
      },
      "JOIN37" : {
        "action" : "join",
        "sources" : [
          "AGGREGATE23",
          "EDIT_ATTRIBUTES22"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "AllProducts.Family",
              "AllProducts.Id",
              "AllProducts.Journal.Accrual_Transactions_Current_Period",
              "AllProducts.Journal.DaysBetweenCurrentTransactions",
              "AllProducts.Journal.Transaction_Amount_Current_Period",
              "AllProducts.Journal.Transaction_Amount_all",
              "AllProducts.Journal.Transaction_Count",
              "AllProducts.Journal.Transactions_all",
              "AllProducts.Name",
              "AllProducts.ProductCode",
              "AllProducts.Product_Count"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "LoyaltyProductId"
          ],
          "rightQualifier" : "AllProducts",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "EXTRACT12" : {
        "action" : "extractGrains",
        "sources" : [
          "JOIN37"
        ],
        "parameters" : {
          "grainExtractions" : [ ]
        }
      },
      "AGGREGATE25" : {
        "action" : "aggregate",
        "sources" : [
          "EXTRACT12"
        ],
        "parameters" : {
          "aggregations" : [
            {
              "action" : "UNIQUE",
              "source" : "LoyaltyProductId",
              "name" : "UNIQUE_LoyaltyProductId1",
              "label" : "Unique Product ID"
            },
            {
              "action" : "SUM",
              "source" : "AllProducts.Avg_Transaction_Amount",
              "name" : "SUM_AllProducts.Avg_Transaction_Amount",
              "label" : "Sum of Avg_Transaction_Amount"
            }
          ],
          "groupings" : [
            "PromotionId"
          ],
          "pivots" : [ ],
          "nodeType" : "STANDARD"
        }
      },
      "EXTRACT13" : {
        "action" : "extractGrains",
        "sources" : [
          "LOAD_DATASET22"
        ],
        "parameters" : {
          "grainExtractions" : [ ]
        }
      },
      "AGGREGATE27" : {
        "action" : "aggregate",
        "sources" : [
          "EXTRACT13"
        ],
        "parameters" : {
          "aggregations" : [
            {
              "action" : "UNIQUE",
              "source" : "ProductCategoryId",
              "name" : "UNIQUE_ProductCategoryId",
              "label" : "Unique Category ID"
            }
          ],
          "groupings" : [
            "PromotionId",
            "ProductCategoryId"
          ],
          "pivots" : [ ],
          "nodeType" : "STANDARD"
        }
      },
      "JOIN38" : {
        "action" : "join",
        "sources" : [
          "AGGREGATE27",
          "EDIT_ATTRIBUTES24"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "AllProductCategories.Id",
              "AllProductCategories.Name",
              "AllProductCategories.Journal.Accrual_Transactions_Current_Period",
              "AllProductCategories.Journal.Transaction_Amount_Current_Period",
              "AllProductCategories.Journal.Transactions_all",
              "AllProductCategories.Journal.Transaction_Amount_all",
              "AllProductCategories.Journal.DaysBetweenCurrentTransactions",
              "AllProductCategories.Journal.Transaction_Count",
              "AllProductCategories.ProductCategory_Count"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "ProductCategoryId"
          ],
          "rightQualifier" : "AllProductCategories",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "EXTRACT14" : {
        "action" : "extractGrains",
        "sources" : [
          "JOIN38"
        ],
        "parameters" : {
          "grainExtractions" : [ ]
        }
      },
      "AGGREGATE29" : {
        "action" : "aggregate",
        "sources" : [
          "EXTRACT14"
        ],
        "parameters" : {
          "aggregations" : [
            {
              "action" : "SUM",
              "source" : "AllProductCategories.Avg_Transaction_Amount",
              "name" : "SUM_AllProductCategories.Avg_Transaction_Amount",
              "label" : "Sum of Avg_Transaction_Amount"
            },
            {
              "action" : "UNIQUE",
              "source" : "ProductCategoryId",
              "name" : "UNIQUE_ProductCategoryId1",
              "label" : "Unique Category ID"
            }
          ],
          "groupings" : [
            "PromotionId"
          ],
          "pivots" : [ ],
          "nodeType" : "STANDARD"
        }
      },
      "LOAD_DATASET23" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name",
            "StartDate",
            "EndDate",
            "LoyaltyPromotionType",
            "IsEnrollmentRequired",
            "EnrollmentStartDate",
            "EnrollmentEndDate",
            "FulfillmentAction",
            "LoyaltyProgramId",
            "MaximumRewardValue",
            "LoyaltyProgramCurrencyId",
            "TotalRewardPoints"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "Promotion",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "Promotion"
          }
        }
      },
      "JOIN39" : {
        "action" : "join",
        "sources" : [
          "LOAD_DATASET23",
          "AGGREGATE21"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "AllPartners.PromotionId"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Id"
          ],
          "rightQualifier" : "AllPartners",
          "rightKeys" : [
            "PromotionId"
          ]
        }
      },
      "JOIN40" : {
        "action" : "join",
        "sources" : [
          "JOIN39",
          "AGGREGATE25"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "AllProducts.PromotionId"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Id"
          ],
          "rightQualifier" : "AllProducts",
          "rightKeys" : [
            "PromotionId"
          ]
        }
      },
      "JOIN41" : {
        "action" : "join",
        "sources" : [
          "JOIN40",
          "AGGREGATE29"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "AllProductCategories.PromotionId"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Id"
          ],
          "rightQualifier" : "AllProductCategories",
          "rightKeys" : [
            "PromotionId"
          ]
        }
      },
      "EDIT_ATTRIBUTES29" : {
        "action" : "schema",
        "sources" : [
          "JOIN47"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "AllPartners.SUM_AllPartners.Avg_Transaction_Amount",
              "newProperties" : {
                "label" : "Total_Avg_Partner_Transaction_Amount",
                "name" : "Total_Avg_Partner_Transaction_Amount",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 18
                }
              }
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES30" : {
        "action" : "schema",
        "sources" : [
          "EDIT_ATTRIBUTES29"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "AllProducts.SUM_AllProducts.Avg_Transaction_Amount",
              "newProperties" : {
                "label" : "Total_Avg_Product_Transaction_Amount",
                "name" : "Total_Avg_Product_Transaction_Amount",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 18
                }
              }
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES31" : {
        "action" : "schema",
        "sources" : [
          "EDIT_ATTRIBUTES30"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "AllProductCategories.SUM_AllProductCategories.Avg_Transaction_Amount",
              "newProperties" : {
                "label" : "Total_Avg_Product_Category_Transaction_Amount",
                "name" : "Total_Avg_Product_Category_Transaction_Amount",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 18
                }
              }
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES32" : {
        "action" : "schema",
        "sources" : [
          "EDIT_ATTRIBUTES31"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "AllPartners.UNIQUE_LoyaltyPartnerId1",
              "newProperties" : {
                "label" : "Partner_Count",
                "name" : "Partner_Count",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 18
                }
              }
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES33" : {
        "action" : "schema",
        "sources" : [
          "EDIT_ATTRIBUTES32"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "AllProducts.UNIQUE_LoyaltyProductId1",
              "newProperties" : {
                "label" : "Product_Count",
                "name" : "Product_Count",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 18
                }
              }
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES34" : {
        "action" : "schema",
        "sources" : [
          "EDIT_ATTRIBUTES33"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "AllProductCategories.UNIQUE_ProductCategoryId1",
              "newProperties" : {
                "label" : "Product_Category_Count",
                "name" : "Product_Category_Count",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 18
                }
              }
            }
          ]
        }
      },
      "FORMULA30" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES34"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Duration",
              "formulaExpression" : "datediff(EndDate, StartDate)",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES35" : {
        "action" : "schema",
        "sources" : [
          "FORMULA30"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Duration",
                "name" : "Duration",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA31" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES35"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula",
              "label" : "Start_Date_Week_Month",
              "formulaExpression" : "coalesce(concat(weekofyear(StartDate), ' - ', month(StartDate)) , '')",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES36" : {
        "action" : "schema",
        "sources" : [
          "FORMULA32"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Start_Date_Week_Month",
                "name" : "Start_Date_Week_Month",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "FORMULA32" : {
        "action" : "formula",
        "sources" : [
          "FORMULA31"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula_formula",
              "label" : "End_Date_Week_Month",
              "formulaExpression" : "coalesce(concat(weekofyear(EndDate), ' - ', month(EndDate)) , '')",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES37" : {
        "action" : "schema",
        "sources" : [
          "EDIT_ATTRIBUTES36"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula_formula",
              "newProperties" : {
                "label" : "End_Date_Week_Month",
                "name" : "End_Date_Week_Month",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "FORMULA33" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES37"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula",
              "label" : "Start_Day",
              "formulaExpression" : "case \nwhen dayofweek(StartDate) = 1 then 'Sunday'\nwhen dayofweek(StartDate) = 2 then 'Monday' \nwhen dayofweek(StartDate) = 3 then 'Tuesday'\nwhen dayofweek(StartDate) = 4 then 'Wednesday' \nwhen dayofweek(StartDate) = 5 then 'Thursday'\nwhen dayofweek(StartDate) = 6 then 'Friday' \nwhen dayofweek(StartDate) = 7 then 'Saturday'\nelse ''\nend",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES38" : {
        "action" : "schema",
        "sources" : [
          "FORMULA33"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Start_Day",
                "name" : "Start_Day",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "FORMULA48" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES38"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Enrollment_Duration",
              "formulaExpression" : "datediff(EnrollmentEndDate, EnrollmentStartDate)",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES53" : {
        "action" : "schema",
        "sources" : [
          "FORMULA48"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Enrollment_Duration",
                "name" : "Enrollment_Duration",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA55" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES53"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Product_or_ProdCategory_Count",
              "formulaExpression" : "Product_Category_Count+Product_Count",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES63" : {
        "action" : "schema",
        "sources" : [
          "FORMULA55"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Product_or_ProdCategory_Count",
                "name" : "Product_or_ProdCategory_Count",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA56" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES63"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Total_Avg_Product_or_ProdCategory_Transaction_Amount",
              "formulaExpression" : "Total_Avg_Product_Transaction_Amount+Total_Avg_Product_Category_Transaction_Amount",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES64" : {
        "action" : "schema",
        "sources" : [
          "FORMULA56"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Total_Avg_Product_or_ProdCategory_Transaction_Amount",
                "name" : "Total_Avg_Product_or_ProdCategory_Transaction_Amount",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "LOAD_DATASET24" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name",
            "PromotionId",
            "MarketSegmentId"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "PromotionMarketSegment",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "PromotionMarketSegment"
          }
        }
      },
      "JOIN42" : {
        "action" : "join",
        "sources" : [
          "LOAD_DATASET24",
          "LOAD_DATASET25"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [ ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "MarketSegmentId"
          ],
          "rightQualifier" : "MarketSegment",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "LOAD_DATASET25" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "MarketSegment",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "MarketSegment"
          }
        }
      },
      "FORMULA34" : {
        "action" : "computeRelative",
        "sources" : [
          "JOIN42"
        ],
        "parameters" : {
          "partitionBy" : [
            "PromotionId"
          ],
          "orderBy" : [
            {
              "fieldName" : "Name",
              "direction" : "ASC"
            }
          ],
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Promotion_Segment_Row_Number",
              "formulaExpression" : "row_number()",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES39" : {
        "action" : "schema",
        "sources" : [
          "FORMULA34"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Promotion_Segment_Row_Number",
                "name" : "Promotion_Segment_Row_Number",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA35" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES39"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula",
              "label" : "Segment1",
              "formulaExpression" : "case \nwhen Promotion_Segment_Row_Number = 1 then \"MarketSegment.Name\" else '-' \nend",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "FORMULA36" : {
        "action" : "formula",
        "sources" : [
          "FORMULA35"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula1",
              "label" : "Segment2",
              "formulaExpression" : "case \nwhen Promotion_Segment_Row_Number = 2 then \"MarketSegment.Name\" else '-' \nend",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "FORMULA37" : {
        "action" : "formula",
        "sources" : [
          "FORMULA36"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula2",
              "label" : "Segment3",
              "formulaExpression" : "case \nwhen Promotion_Segment_Row_Number = 3 then \"MarketSegment.Name\" else '-' \nend",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "FORMULA38" : {
        "action" : "formula",
        "sources" : [
          "FORMULA37"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula3",
              "label" : "Segment4",
              "formulaExpression" : "case \nwhen Promotion_Segment_Row_Number = 4 then \"MarketSegment.Name\" else '-' \nend",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "FORMULA39" : {
        "action" : "formula",
        "sources" : [
          "FORMULA38"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula4",
              "label" : "Segment5",
              "formulaExpression" : "case \nwhen Promotion_Segment_Row_Number = 5 then \"MarketSegment.Name\" else '-' \nend",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES40" : {
        "action" : "schema",
        "sources" : [
          "FORMULA39"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Segment1",
                "name" : "Segment1",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES41" : {
        "action" : "schema",
        "sources" : [
          "EDIT_ATTRIBUTES40"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula1",
              "newProperties" : {
                "label" : "Segment2",
                "name" : "Segment2",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES42" : {
        "action" : "schema",
        "sources" : [
          "EDIT_ATTRIBUTES41"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula2",
              "newProperties" : {
                "label" : "Segment3",
                "name" : "Segment3",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES43" : {
        "action" : "schema",
        "sources" : [
          "EDIT_ATTRIBUTES42"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula3",
              "newProperties" : {
                "label" : "Segment4",
                "name" : "Segment4",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES44" : {
        "action" : "schema",
        "sources" : [
          "EDIT_ATTRIBUTES43"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula4",
              "newProperties" : {
                "label" : "Segment5",
                "name" : "Segment5",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "FILTER5" : {
        "action" : "filter",
        "sources" : [
          "EDIT_ATTRIBUTES44"
        ],
        "parameters" : {
          "filterExpressions" : [
            {
              "type" : "TEXT",
              "field" : "Segment1",
              "operator" : "NOT",
              "operands" : [
                "-"
              ]
            }
          ]
        }
      },
      "FILTER6" : {
        "action" : "filter",
        "sources" : [
          "EDIT_ATTRIBUTES44"
        ],
        "parameters" : {
          "filterExpressions" : [
            {
              "type" : "TEXT",
              "field" : "Segment2",
              "operator" : "NOT",
              "operands" : [
                "-"
              ]
            }
          ]
        }
      },
      "FILTER7" : {
        "action" : "filter",
        "sources" : [
          "EDIT_ATTRIBUTES44"
        ],
        "parameters" : {
          "filterExpressions" : [
            {
              "type" : "TEXT",
              "field" : "Segment3",
              "operator" : "NOT",
              "operands" : [
                "-"
              ]
            }
          ]
        }
      },
      "FILTER8" : {
        "action" : "filter",
        "sources" : [
          "EDIT_ATTRIBUTES44"
        ],
        "parameters" : {
          "filterExpressions" : [
            {
              "type" : "TEXT",
              "field" : "Segment4",
              "operator" : "NOT",
              "operands" : [
                "-"
              ]
            }
          ]
        }
      },
      "FILTER9" : {
        "action" : "filter",
        "sources" : [
          "EDIT_ATTRIBUTES44"
        ],
        "parameters" : {
          "filterExpressions" : [
            {
              "type" : "TEXT",
              "field" : "Segment5",
              "operator" : "NOT",
              "operands" : [
                "-"
              ]
            }
          ]
        }
      },
      "JOIN43" : {
        "action" : "join",
        "sources" : [
          "JOIN48",
          "FILTER5"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "MarketSegment1.Id",
              "MarketSegment1.MarketSegment.Id",
              "MarketSegment1.MarketSegment.Name",
              "MarketSegment1.MarketSegmentId",
              "MarketSegment1.Name",
              "MarketSegment1.PromotionId",
              "MarketSegment1.Promotion_Segment_Row_Number",
              "MarketSegment1.Segment2",
              "MarketSegment1.Segment3",
              "MarketSegment1.Segment4",
              "MarketSegment1.Segment5"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Id"
          ],
          "rightQualifier" : "MarketSegment1",
          "rightKeys" : [
            "PromotionId"
          ]
        }
      },
      "JOIN44" : {
        "action" : "join",
        "sources" : [
          "JOIN43",
          "FILTER6"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "MarketSegment2.Id",
              "MarketSegment2.MarketSegment.Id",
              "MarketSegment2.MarketSegment.Name",
              "MarketSegment2.MarketSegmentId",
              "MarketSegment2.Name",
              "MarketSegment2.PromotionId",
              "MarketSegment2.Promotion_Segment_Row_Number",
              "MarketSegment2.Segment1",
              "MarketSegment2.Segment3",
              "MarketSegment2.Segment4",
              "MarketSegment2.Segment5"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Id"
          ],
          "rightQualifier" : "MarketSegment2",
          "rightKeys" : [
            "PromotionId"
          ]
        }
      },
      "JOIN45" : {
        "action" : "join",
        "sources" : [
          "JOIN44",
          "FILTER7"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "MarketSegment3.Id",
              "MarketSegment3.Name",
              "MarketSegment3.PromotionId",
              "MarketSegment3.MarketSegmentId",
              "MarketSegment3.MarketSegment.Id",
              "MarketSegment3.MarketSegment.Name",
              "MarketSegment3.Promotion_Segment_Row_Number",
              "MarketSegment3.Segment1",
              "MarketSegment3.Segment2",
              "MarketSegment3.Segment4",
              "MarketSegment3.Segment5"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Id"
          ],
          "rightQualifier" : "MarketSegment3",
          "rightKeys" : [
            "PromotionId"
          ]
        }
      },
      "JOIN46" : {
        "action" : "join",
        "sources" : [
          "JOIN45",
          "FILTER8"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "MarketSegment4.Id",
              "MarketSegment4.Name",
              "MarketSegment4.PromotionId",
              "MarketSegment4.MarketSegmentId",
              "MarketSegment4.MarketSegment.Id",
              "MarketSegment4.MarketSegment.Name",
              "MarketSegment4.Promotion_Segment_Row_Number",
              "MarketSegment4.Segment1",
              "MarketSegment4.Segment2",
              "MarketSegment4.Segment3",
              "MarketSegment4.Segment5"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Id"
          ],
          "rightQualifier" : "MarketSegment4",
          "rightKeys" : [
            "PromotionId"
          ]
        }
      },
      "JOIN47" : {
        "action" : "join",
        "sources" : [
          "JOIN46",
          "FILTER9"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "MarketSegment5.Id",
              "MarketSegment5.MarketSegment.Id",
              "MarketSegment5.MarketSegment.Name",
              "MarketSegment5.MarketSegmentId",
              "MarketSegment5.PromotionId",
              "MarketSegment5.Promotion_Segment_Row_Number",
              "MarketSegment5.Segment1",
              "MarketSegment5.Segment2",
              "MarketSegment5.Segment3",
              "MarketSegment5.Segment4"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Id"
          ],
          "rightQualifier" : "MarketSegment5",
          "rightKeys" : [
            "PromotionId"
          ]
        }
      },
      "LOAD_DATASET26" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name",
            "LoyaltyProgramId"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "LoyaltyProgramCurrency",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "LoyaltyProgramCurrency"
          }
        }
      },
      "JOIN48" : {
        "action" : "join",
        "sources" : [
          "JOIN41",
          "LOAD_DATASET26"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "ProgramCurrency.Id",
              "ProgramCurrency.LoyaltyProgramId"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "LoyaltyProgramCurrencyId"
          ],
          "rightQualifier" : "ProgramCurrency",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "JOIN49" : {
        "action" : "join",
        "sources" : [
          "JOIN31",
          "EDIT_ATTRIBUTES64"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "Promotion.Id",
              "Promotion.LoyaltyProgramCurrencyId",
              "Promotion.LoyaltyProgramId"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Id"
          ],
          "rightQualifier" : "Promotion",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "JOIN50" : {
        "action" : "join",
        "sources" : [
          "JOIN34",
          "EDIT_ATTRIBUTES64"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "Promotion.LoyaltyProgramId",
              "Promotion.LoyaltyProgramCurrencyId"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Promotion_Id"
          ],
          "rightQualifier" : "Promotion",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "FORMULA40" : {
        "action" : "formula",
        "sources" : [
          "JOIN52"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Membership_Duration",
              "formulaExpression" : "datediff(now(), EnrollmentDate)",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES45" : {
        "action" : "schema",
        "sources" : [
          "FORMULA40"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Membership_Duration",
                "name" : "Membership_Duration",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA44" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES45"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "MemberCurrency.Ledger.Current_Accrued_Points_formula",
              "label" : "Average_NQP_Accrued",
              "formulaExpression" : "coalesce(coalesce(\"MemberCurrency.Ledger.Current_Accrued_Points\",0) / \"MemberCurrency.Ledger.Journal.Accrual_Transactions_Current_Period\",0)",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES49" : {
        "action" : "schema",
        "sources" : [
          "FORMULA44"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "MemberCurrency.Ledger.Current_Accrued_Points_formula",
              "newProperties" : {
                "label" : "Average_NQP_Accrued",
                "name" : "Average_NQP_Accrued",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA49" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES49"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Avg_Transaction_Amount_all",
              "formulaExpression" : "coalesce(\"Journal.Transaction_Amount_all\"/ \"Journal.Transactions_all\", 0)",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES54" : {
        "action" : "schema",
        "sources" : [
          "FORMULA49"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Avg_Transaction_Amount_all",
                "name" : "Avg_Transaction_Amount_all",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA50" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES54"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Month_In_Tier",
              "formulaExpression" : "months_between(now() , \"Tier.EffectiveDate\")",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES55" : {
        "action" : "schema",
        "sources" : [
          "FORMULA50"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Month_In_Tier",
                "name" : "Month_In_Tier",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA51" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES55"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula",
              "label" : "Member_State_City",
              "formulaExpression" : "case \nwhen MemberType = 'Individual' then concat(\"Contact.MailingState\" , ' - ' , \"Contact.MailingCity\")\nwhen MemberType = 'Corporate' then concat(\"Account.BillingState\" , ' - ' , \"Account.BillingCity\")\nelse ' - '\nend",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES56" : {
        "action" : "schema",
        "sources" : [
          "FORMULA51"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Member_State_City",
                "name" : "Member_State_City",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "FORMULA52" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES56"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "Age",
              "formulaExpression" : "months_between(now(), \"Contact.Birthdate\")/12",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES57" : {
        "action" : "schema",
        "sources" : [
          "FORMULA52"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Age",
                "name" : "Age",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "FORMULA57" : {
        "action" : "formula",
        "sources" : [
          "EDIT_ATTRIBUTES57"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "NUMBER",
              "name" : "Id_formula",
              "label" : "DaysSinceLastTransaction",
              "formulaExpression" : "datediff(now(), \"Transaction.Last_Transaction_Activity_Date\")",
              "precision" : 10,
              "scale" : 0,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES65" : {
        "action" : "schema",
        "sources" : [
          "FORMULA57"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "DaysSinceLastTransaction",
                "name" : "DaysSinceLastTransaction",
                "typeProperties" : {
                  "type" : "NUMBER",
                  "scale" : 0,
                  "precision" : 10
                }
              }
            }
          ]
        }
      },
      "LOAD_DATASET27" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name",
            "LoyaltyProgramId",
            "IsPrimary"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "LoyaltyTierGroup",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "LoyaltyTierGroup"
          }
        }
      },
      "LOAD_DATASET28" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name",
            "LoyaltyMemberId",
            "LoyaltyTierId",
            "LoyaltyTierGroupId",
            "EffectiveDate"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "LoyaltyMemberTier",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "LoyaltyMemberTier"
          }
        }
      },
      "FORMULA41" : {
        "action" : "computeRelative",
        "sources" : [
          "LOAD_DATASET27"
        ],
        "parameters" : {
          "partitionBy" : [
            "LoyaltyProgramId"
          ],
          "orderBy" : [
            {
              "fieldName" : "IsPrimary",
              "direction" : "DESC"
            }
          ],
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula",
              "label" : "Selected_Tier_Group",
              "formulaExpression" : "first_value(Id)",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES46" : {
        "action" : "schema",
        "sources" : [
          "FORMULA42"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Selected_Tier_Group_Id",
                "name" : "Selected_Tier_Group_Id",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "FORMULA42" : {
        "action" : "computeRelative",
        "sources" : [
          "FORMULA41"
        ],
        "parameters" : {
          "partitionBy" : [
            "LoyaltyProgramId"
          ],
          "orderBy" : [
            {
              "fieldName" : "IsPrimary",
              "direction" : "DESC"
            }
          ],
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula_formula",
              "label" : "Selected_Tier_Group_Name",
              "formulaExpression" : "first_value(Name)",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES47" : {
        "action" : "schema",
        "sources" : [
          "EDIT_ATTRIBUTES46"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula_formula",
              "newProperties" : {
                "label" : "Selected_Tier_Group_Name",
                "name" : "Selected_Tier_Group_Name",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "EXTRACT15" : {
        "action" : "extractGrains",
        "sources" : [
          "EDIT_ATTRIBUTES47"
        ],
        "parameters" : {
          "grainExtractions" : [ ]
        }
      },
      "AGGREGATE31" : {
        "action" : "aggregate",
        "sources" : [
          "EXTRACT15"
        ],
        "parameters" : {
          "aggregations" : [
            {
              "action" : "UNIQUE",
              "source" : "Id",
              "name" : "UNIQUE_Id",
              "label" : "Unique Loyalty Tier Group ID"
            }
          ],
          "groupings" : [
            "Selected_Tier_Group_Id",
            "Selected_Tier_Group_Name"
          ],
          "pivots" : [ ],
          "nodeType" : "STANDARD"
        }
      },
      "JOIN51" : {
        "action" : "join",
        "sources" : [
          "LOAD_DATASET28",
          "AGGREGATE31"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "TierGroup.UNIQUE_Id"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "LoyaltyTierGroupId"
          ],
          "rightQualifier" : "TierGroup",
          "rightKeys" : [
            "Selected_Tier_Group_Id"
          ]
        }
      },
      "FILTER10" : {
        "action" : "filter",
        "sources" : [
          "JOIN51"
        ],
        "parameters" : {
          "filterExpressions" : [
            {
              "type" : "TEXT",
              "field" : "TierGroup.Selected_Tier_Group_Name",
              "operator" : "IS_NOT_NULL",
              "operands" : [ ]
            }
          ]
        }
      },
      "JOIN52" : {
        "action" : "join",
        "sources" : [
          "JOIN54",
          "FILTER10"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "Tier.Id",
              "Tier.LoyaltyMemberId",
              "Tier.LoyaltyTierId",
              "Tier.LoyaltyTierGroupId",
              "Tier.TierGroup.Selected_Tier_Group_Id",
              "Tier.TierGroup.Selected_Tier_Group_Name"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Id"
          ],
          "rightQualifier" : "Tier",
          "rightKeys" : [
            "LoyaltyMemberId"
          ]
        }
      },
      "LOAD_DATASET29" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "AccountId",
            "Name",
            "MailingCity",
            "MailingState",
            "MailingCountry",
            "Birthdate"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "Contact",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "Contact"
          }
        }
      },
      "JOIN53" : {
        "action" : "join",
        "sources" : [
          "JOIN10",
          "LOAD_DATASET29"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [ ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "ContactId"
          ],
          "rightQualifier" : "Contact",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "LOAD_DATASET30" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name",
            "BillingCity",
            "BillingState",
            "BillingCountry",
            "ShippingCity",
            "ShippingState",
            "ShippingCountry"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "Account",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "Account"
          }
        }
      },
      "JOIN54" : {
        "action" : "join",
        "sources" : [
          "JOIN53",
          "LOAD_DATASET30"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "Account.ShippingCity",
              "Account.ShippingState",
              "Account.ShippingCountry"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "AccountId"
          ],
          "rightQualifier" : "Account",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "APPEND0" : {
        "action" : "appendV2",
        "sources" : [
          "EDIT_ATTRIBUTES51",
          "EDIT_ATTRIBUTES50"
        ],
        "parameters" : {
          "fieldMappings" : [
            {
              "top" : "Id",
              "bottom" : "Promotion_Id"
            },
            {
              "top" : "Name",
              "bottom" : "Promotion.Name"
            },
            {
              "top" : "StartDate",
              "bottom" : "Promotion.StartDate"
            },
            {
              "top" : "EndDate",
              "bottom" : "Promotion.EndDate"
            },
            {
              "top" : "FulfillmentAction",
              "bottom" : "Promotion.FulfillmentAction"
            },
            {
              "top" : "LoyaltyProgramId",
              "bottom" : "ProgramMember.ProgramId"
            },
            {
              "top" : "LoyaltyProgramCurrencyId",
              "bottom" : "Promo.LoyaltyProgramCurrencyId"
            },
            {
              "top" : "PromotionCurrency.Name",
              "bottom" : "Promo.PromotionCurrency.Name"
            },
            {
              "top" : "Program.Id",
              "bottom" : "Members.Program.Id"
            },
            {
              "top" : "Program.Name",
              "bottom" : "Loyalty_Program"
            },
            {
              "top" : "Member.Id",
              "bottom" : "ProgramMember.Id"
            },
            {
              "top" : "Member.MembershipNumber",
              "bottom" : "Membership_Number"
            },
            {
              "top" : "Member.ProgramId",
              "bottom" : "Members.Program.Id"
            },
            {
              "top" : "Member.prog.Name",
              "bottom" : "Loyalty_Program"
            },
            {
              "top" : "Member_Segment.Loyalty_Program",
              "bottom" : "Member_Segment.Loyalty_Program"
            },
            {
              "top" : "Member_Segment.Hobby",
              "bottom" : "Member_Segment.Hobby"
            },
            {
              "top" : "Member_Segment.Membership_Number",
              "bottom" : "Member_Segment.Membership_Number"
            },
            {
              "top" : "Member_Segment.Market_Segment_1",
              "bottom" : "Member_Segment.Market_Segment_1"
            },
            {
              "top" : "Member_Segment.Market_Segment_2",
              "bottom" : "Member_Segment.Market_Segment_2"
            },
            {
              "top" : "Partner_Overlap.Partner_Overlap",
              "bottom" : "Partner_Overlap.Partner_Overlap"
            },
            {
              "top" : "Product_Overlap.UNIQUE_Product_or_Prod_Category_ID",
              "bottom" : "Product_Overlap.UNIQUE_Product_or_Prod_Category_ID"
            },
            {
              "top" : "Product_Overlap.Product_Overlap",
              "bottom" : "Product_Overlap.Product_Overlap"
            },
            {
              "top" : "ProductCategory_Overlap.ProductCategory_Overlap",
              "bottom" : "ProductCategory_Overlap.ProductCategory_Overlap"
            },
            {
              "top" : "Promotion.Name",
              "bottom" : "Promotion.Name"
            },
            {
              "top" : "Promotion.StartDate",
              "bottom" : "Promotion.StartDate"
            },
            {
              "top" : "Promotion.EndDate",
              "bottom" : "Promotion.EndDate"
            },
            {
              "top" : "Promotion.LoyaltyPromotionType",
              "bottom" : "Promotion.LoyaltyPromotionType"
            },
            {
              "top" : "Promotion.IsEnrollmentRequired",
              "bottom" : "Promotion.IsEnrollmentRequired"
            },
            {
              "top" : "Promotion.EnrollmentStartDate",
              "bottom" : "Promotion.EnrollmentStartDate"
            },
            {
              "top" : "Promotion.EnrollmentEndDate",
              "bottom" : "Promotion.EnrollmentEndDate"
            },
            {
              "top" : "Promotion.FulfillmentAction",
              "bottom" : "Promotion.FulfillmentAction"
            },
            {
              "top" : "Promotion.MaximumRewardValue",
              "bottom" : "Promotion.MaximumRewardValue"
            },
            {
              "top" : "Promotion.TotalRewardPoints",
              "bottom" : "Promotion.TotalRewardPoints"
            },
            {
              "top" : "Promotion.ProgramCurrency.Name",
              "bottom" : "Promotion.ProgramCurrency.Name"
            },
            {
              "top" : "Promotion.MarketSegment1.Segment1",
              "bottom" : "Promotion.MarketSegment1.Segment1"
            },
            {
              "top" : "Promotion.MarketSegment2.Segment2",
              "bottom" : "Promotion.MarketSegment2.Segment2"
            },
            {
              "top" : "Promotion.MarketSegment3.Segment3",
              "bottom" : "Promotion.MarketSegment3.Segment3"
            },
            {
              "top" : "Promotion.MarketSegment4.Segment4",
              "bottom" : "Promotion.MarketSegment4.Segment4"
            },
            {
              "top" : "Promotion.MarketSegment5.Name",
              "bottom" : "Promotion.MarketSegment5.Name"
            },
            {
              "top" : "Promotion.MarketSegment5.Segment5",
              "bottom" : "Promotion.MarketSegment5.Segment5"
            },
            {
              "top" : "Promotion.Total_Avg_Partner_Transaction_Amount",
              "bottom" : "Promotion.Total_Avg_Partner_Transaction_Amount"
            },
            {
              "top" : "Promotion.Total_Avg_Product_Transaction_Amount",
              "bottom" : "Promotion.Total_Avg_Product_Transaction_Amount"
            },
            {
              "top" : "Promotion.Total_Avg_Product_Category_Transaction_Amount",
              "bottom" : "Promotion.Total_Avg_Product_Category_Transaction_Amount"
            },
            {
              "top" : "Promotion.Partner_Count",
              "bottom" : "Promotion.Partner_Count"
            },
            {
              "top" : "Promotion.Product_Count",
              "bottom" : "Promotion.Product_Count"
            },
            {
              "top" : "Promotion.Product_Category_Count",
              "bottom" : "Promotion.Product_Category_Count"
            },
            {
              "top" : "Promotion.Duration",
              "bottom" : "Promotion.Duration"
            },
            {
              "top" : "Promotion.Start_Date_Week_Month",
              "bottom" : "Promotion.Start_Date_Week_Month"
            },
            {
              "top" : "Promotion.End_Date_Week_Month",
              "bottom" : "Promotion.End_Date_Week_Month"
            },
            {
              "top" : "Promotion.Start_Day",
              "bottom" : "Promotion.Start_Day"
            },
            {
              "top" : "Promotion.Enrollment_Duration",
              "bottom" : "Promotion.Enrollment_Duration"
            },
            {
              "top" : "Promotion.Product_or_ProdCategory_Count",
              "bottom" : "Promotion.Product_or_ProdCategory_Count"
            },
            {
              "top" : "Promotion.Total_Avg_Product_or_ProdCategory_Transaction_Amount",
              "bottom" : "Promotion.Total_Avg_Product_or_ProdCategory_Transaction_Amount"
            },
            {
              "top" : "Members.Id",
              "bottom" : "Members.Id"
            },
            {
              "top" : "Members.MembershipNumber",
              "bottom" : "ProgramMember.MembershipNumber"
            },
            {
              "top" : "Members.ProgramId",
              "bottom" : "Members.ProgramId"
            },
            {
              "top" : "Members.MemberType",
              "bottom" : "Members.MemberType"
            },
            {
              "top" : "Members.ReferredById",
              "bottom" : "Members.ReferredById"
            },
            {
              "top" : "Members.EnrollmentDate",
              "bottom" : "Members.EnrollmentDate"
            },
            {
              "top" : "Members.MemberStatus",
              "bottom" : "Members.MemberStatus"
            },
            {
              "top" : "Members.EnrollmentChannel",
              "bottom" : "Members.EnrollmentChannel"
            },
            {
              "top" : "Members.AccountId",
              "bottom" : "Members.AccountId"
            },
            {
              "top" : "Members.ContactId",
              "bottom" : "Members.ContactId"
            },
            {
              "top" : "Members.Program.Id",
              "bottom" : "Members.Program.Id"
            },
            {
              "top" : "Members.Program.Name",
              "bottom" : "Members.Program.Name"
            },
            {
              "top" : "Members.Program.Status",
              "bottom" : "Members.Program.Status"
            },
            {
              "top" : "Members.MemberCurrency.Id",
              "bottom" : "Members.MemberCurrency.Id"
            },
            {
              "top" : "Members.MemberCurrency.Name",
              "bottom" : "Members.MemberCurrency.Name"
            },
            {
              "top" : "Members.MemberCurrency.LoyaltyMemberId",
              "bottom" : "Members.MemberCurrency.LoyaltyMemberId"
            },
            {
              "top" : "Members.MemberCurrency.LoyaltyProgramCurrencyId",
              "bottom" : "Members.MemberCurrency.LoyaltyProgramCurrencyId"
            },
            {
              "top" : "Members.MemberCurrency.PointsBalance",
              "bottom" : "Members.MemberCurrency.PointsBalance"
            },
            {
              "top" : "Members.MemberCurrency.ProgramCurrency.Id",
              "bottom" : "Members.MemberCurrency.ProgramCurrency.Id"
            },
            {
              "top" : "Members.MemberCurrency.ProgramCurrency.Name",
              "bottom" : "Members.MemberCurrency.ProgramCurrency.Name"
            },
            {
              "top" : "Members.MemberCurrency.ProgramCurrency.LoyaltyProgramId",
              "bottom" : "Members.MemberCurrency.ProgramCurrency.LoyaltyProgramId"
            },
            {
              "top" : "Members.MemberCurrency.ProgramCurrency.CurrencyType",
              "bottom" : "Members.MemberCurrency.ProgramCurrency.CurrencyType"
            },
            {
              "top" : "Members.MemberCurrency.ProgramCurrency.LoyaltyTierGroupId",
              "bottom" : "Members.MemberCurrency.ProgramCurrency.LoyaltyTierGroupId"
            },
            {
              "top" : "Members.MemberCurrency.ProgramCurrency.IsActive",
              "bottom" : "Members.MemberCurrency.ProgramCurrency.IsActive"
            },
            {
              "top" : "Members.MemberCurrency.Ledger.Points",
              "bottom" : "Members.MemberCurrency.Ledger.Points"
            },
            {
              "top" : "Members.MemberCurrency.Ledger.Journal.Accrual_Transactions_Current_Period",
              "bottom" : "Members.MemberCurrency.Ledger.Journal.Accrual_Transactions_Current_Period"
            },
            {
              "top" : "Members.MemberCurrency.Ledger.Journal.Transaction_Amount_Current_Period",
              "bottom" : "Members.MemberCurrency.Ledger.Journal.Transaction_Amount_Current_Period"
            },
            {
              "top" : "Members.MemberCurrency.Ledger.Journal.Transactions_all",
              "bottom" : "Members.MemberCurrency.Ledger.Journal.Transactions_all"
            },
            {
              "top" : "Members.MemberCurrency.Ledger.Journal.Transaction_Amount_all",
              "bottom" : "Members.MemberCurrency.Ledger.Journal.Transaction_Amount_all"
            },
            {
              "top" : "Members.MemberCurrency.Ledger.Journal.DaysBetweenCurrentTransactions",
              "bottom" : "Members.MemberCurrency.Ledger.Journal.DaysBetweenCurrentTransactions"
            },
            {
              "top" : "Members.MemberCurrency.Ledger.Journal.Accrual_Transaction_Amount",
              "bottom" : "Members.MemberCurrency.Ledger.Journal.Accrual_Transaction_Amount"
            },
            {
              "top" : "Members.MemberCurrency.Ledger.Journal.Transaction_Count",
              "bottom" : "Members.MemberCurrency.Ledger.Journal.Transaction_Count"
            },
            {
              "top" : "Members.MemberCurrency.Ledger.Current_Accrued_Points",
              "bottom" : "Members.MemberCurrency.Ledger.Current_Accrued_Points"
            },
            {
              "top" : "Members.MemberCurrency.Ledger.Current_Expired_Points",
              "bottom" : "Members.MemberCurrency.Ledger.Current_Expired_Points"
            },
            {
              "top" : "Members.MemberCurrency.Ledger.Promotion_Revenue",
              "bottom" : "Members.MemberCurrency.Ledger.Promotion_Revenue"
            },
            {
              "top" : "Members.Transaction.Id",
              "bottom" : "Members.Transaction.Id"
            },
            {
              "top" : "Members.Transaction.MemberId",
              "bottom" : "Members.Transaction.MemberId"
            },
            {
              "top" : "Members.Transaction.ActivityDate",
              "bottom" : "Members.Transaction.ActivityDate"
            },
            {
              "top" : "Members.Transaction.Status",
              "bottom" : "Members.Transaction.Status"
            },
            {
              "top" : "Members.Transaction.StartDate",
              "bottom" : "Members.Transaction.StartDate"
            },
            {
              "top" : "Members.Transaction.TransactionAmount",
              "bottom" : "Members.Transaction.TransactionAmount"
            },
            {
              "top" : "Members.Transaction.PaymentMethod",
              "bottom" : "Members.Transaction.PaymentMethod"
            },
            {
              "top" : "Members.Transaction.PartnerId",
              "bottom" : "Members.Transaction.PartnerId"
            },
            {
              "top" : "Members.Transaction.ProductId",
              "bottom" : "Members.Transaction.ProductId"
            },
            {
              "top" : "Members.Transaction.ProductCategoryId",
              "bottom" : "Members.Transaction.ProductCategoryId"
            },
            {
              "top" : "Members.Transaction.ReferredMemberId",
              "bottom" : "Members.Transaction.ReferredMemberId"
            },
            {
              "top" : "Members.Transaction.RelatedJournalId",
              "bottom" : "Members.Transaction.RelatedJournalId"
            },
            {
              "top" : "Members.Transaction.LoyaltyProgramId",
              "bottom" : "Members.Transaction.LoyaltyProgramId"
            },
            {
              "top" : "Members.Transaction.JournalType.Name",
              "bottom" : "Members.Transaction.JournalType.Name"
            },
            {
              "top" : "Members.Transaction.ActivityDate_Flag",
              "bottom" : "Members.Transaction.ActivityDate_Flag"
            },
            {
              "top" : "Members.Transaction.Accrual_Transactions_Current_Period",
              "bottom" : "Members.Transaction.Accrual_Transactions_Current_Period"
            },
            {
              "top" : "Members.Transaction.Transaction_Amount_Current_Period",
              "bottom" : "Members.Transaction.Transaction_Amount_Current_Period"
            },
            {
              "top" : "Members.Transaction.Transactions_all",
              "bottom" : "Members.Transaction.Transactions_all"
            },
            {
              "top" : "Members.Transaction.Transaction_Amount_all",
              "bottom" : "Members.Transaction.Transaction_Amount_all"
            },
            {
              "top" : "Members.Transaction.Current_ActivityDate",
              "bottom" : "Members.Transaction.Current_ActivityDate"
            },
            {
              "top" : "Members.Transaction.DaysBetweenCurrentTransactions",
              "bottom" : "Members.Transaction.DaysBetweenCurrentTransactions"
            },
            {
              "top" : "Members.Transaction.Accrual_Transaction_Amount",
              "bottom" : "Members.Transaction.Accrual_Transaction_Amount"
            },
            {
              "top" : "Members.Transaction.Last_Transaction_Activity_Date",
              "bottom" : "Members.Transaction.Last_Transaction_Activity_Date"
            },
            {
              "top" : "Members.Transaction.Transaction_Count",
              "bottom" : "Members.Transaction.Transaction_Count"
            },
            {
              "top" : "Members.Journal.Accrual_Transactions_Current_Period",
              "bottom" : "Members.Journal.Accrual_Transactions_Current_Period"
            },
            {
              "top" : "Members.Journal.Transaction_Amount_Current_Period",
              "bottom" : "Members.Journal.Transaction_Amount_Current_Period"
            },
            {
              "top" : "Members.Journal.Transactions_all",
              "bottom" : "Members.Journal.Transactions_all"
            },
            {
              "top" : "Members.Journal.Transaction_Amount_all",
              "bottom" : "Members.Journal.Transaction_Amount_all"
            },
            {
              "top" : "Members.Journal.DaysBetweenCurrentTransactions",
              "bottom" : "Members.Journal.DaysBetweenCurrentTransactions"
            },
            {
              "top" : "Members.Journal.Accrual_Transaction_Amount",
              "bottom" : "Members.Journal.Accrual_Transaction_Amount"
            },
            {
              "top" : "Members.Journal.Transaction_Count",
              "bottom" : "Members.Journal.Transaction_Count"
            },
            {
              "top" : "Members.Contact.Id",
              "bottom" : "Members.Contact.Id"
            },
            {
              "top" : "Members.Contact.AccountId",
              "bottom" : "Members.Contact.AccountId"
            },
            {
              "top" : "Members.Contact.Name",
              "bottom" : "Members.Contact.Name"
            },
            {
              "top" : "Members.Contact.MailingCity",
              "bottom" : "Members.Contact.MailingCity"
            },
            {
              "top" : "Members.Contact.MailingState",
              "bottom" : "Members.Contact.MailingState"
            },
            {
              "top" : "Members.Contact.MailingCountry",
              "bottom" : "Members.Contact.MailingCountry"
            },
            {
              "top" : "Members.Contact.Birthdate",
              "bottom" : "Members.Contact.Birthdate"
            },
            {
              "top" : "Members.Account.Id",
              "bottom" : "Members.Account.Id"
            },
            {
              "top" : "Members.Account.Name",
              "bottom" : "Members.Account.Name"
            },
            {
              "top" : "Members.Account.BillingCity",
              "bottom" : "Members.Account.BillingCity"
            },
            {
              "top" : "Members.Account.BillingState",
              "bottom" : "Members.Account.BillingState"
            },
            {
              "top" : "Members.Account.BillingCountry",
              "bottom" : "Members.Account.BillingCountry"
            },
            {
              "top" : "Members.Tier.Name",
              "bottom" : "Members.Tier.Name"
            },
            {
              "top" : "Members.Tier.EffectiveDate",
              "bottom" : "Members.Tier.EffectiveDate"
            },
            {
              "top" : "Members.Membership_Duration",
              "bottom" : "Members.Membership_Duration"
            },
            {
              "top" : "Members.Average_NQP_Accrued",
              "bottom" : "Members.Average_NQP_Accrued"
            },
            {
              "top" : "Members.Avg_Transaction_Amount_all",
              "bottom" : "Members.Avg_Transaction_Amount_all"
            },
            {
              "top" : "Members.Month_In_Tier",
              "bottom" : "Members.Month_In_Tier"
            },
            {
              "top" : "Members.Member_State_City",
              "bottom" : "Members.Member_State_City"
            },
            {
              "top" : "Members.Age",
              "bottom" : "Members.Age"
            },
            {
              "top" : "Members.DaysSinceLastTransaction",
              "bottom" : "Members.DaysSinceLastTransaction"
            },
            {
              "top" : "isTraining",
              "bottom" : "isTraining"
            }
          ]
        }
      },
      "FORMULA45" : {
        "action" : "formula",
        "sources" : [
          "JOIN25"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Membership_Number_formula",
              "label" : "isTraining",
              "formulaExpression" : "'true'",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES50" : {
        "action" : "schema",
        "sources" : [
          "FORMULA45"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Membership_Number_formula",
              "newProperties" : {
                "label" : "isTraining",
                "name" : "isTraining",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "FORMULA46" : {
        "action" : "formula",
        "sources" : [
          "JOIN22"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "StartDate_formula",
              "label" : "isTraining",
              "formulaExpression" : "'false'",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES51" : {
        "action" : "schema",
        "sources" : [
          "FORMULA46"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "StartDate_formula",
              "newProperties" : {
                "label" : "isTraining",
                "name" : "isTraining",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "FILTER11" : {
        "action" : "filter",
        "sources" : [
          "APPEND0"
        ],
        "parameters" : {
          "filterExpressions" : [
            {
              "type" : "TEXT",
              "field" : "isTraining",
              "operator" : "EQUAL",
              "operands" : [
                "false"
              ]
            }
          ]
        }
      },
      "FILTER12" : {
        "action" : "filter",
        "sources" : [
          "EDIT_ATTRIBUTES15"
        ],
        "parameters" : {
          "filterExpressions" : [
            {
              "type" : "TEXT",
              "field" : "StartDate_Flag",
              "operator" : "EQUAL",
              "operands" : [
                "Training Promotions"
              ]
            },
            {
              "type" : "TEXT",
              "field" : "Program.Name",
              "operator" : "EQUAL",
              "operands" : [
                "NTO Insider"
              ]
            },
            {
              "type" : "TEXT",
              "field" : "FulfillmentAction",
              "operator" : "EQUAL",
              "operands" : [
                "CreditPoints"
              ]
            }
          ]
        }
      },
      "JOIN55" : {
        "action" : "join",
        "sources" : [
          "JOIN23",
          "FILTER12"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "Promo.Name",
              "Promo.Program.Id",
              "Promo.Program.Name",
              "Promo.StartDate_Flag"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "Promotion_Id"
          ],
          "rightQualifier" : "Promo",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "FILTER13" : {
        "action" : "filter",
        "sources" : [
          "JOIN55"
        ],
        "parameters" : {
          "filterExpressions" : [
            {
              "type" : "TEXT",
              "field" : "Promo.Id",
              "operator" : "IS_NOT_NULL",
              "operands" : [ ]
            },
            {
              "type" : "TEXT",
              "field" : "Loyalty_Program",
              "operator" : "EQUAL",
              "operands" : [
                "NTO Insider"
              ]
            }
          ]
        }
      },
      "LOAD_DATASET31" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "LoyaltyProgram",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "LoyaltyProgram"
          }
        }
      },
      "JOIN56" : {
        "action" : "join",
        "sources" : [
          "LOAD_DATASET16",
          "LOAD_DATASET31"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "prog.Id"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "ProgramId"
          ],
          "rightQualifier" : "prog",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "FILTER14" : {
        "action" : "filter",
        "sources" : [
          "JOIN56"
        ],
        "parameters" : {
          "filterExpressions" : [
            {
              "type" : "TEXT",
              "field" : "prog.Name",
              "operator" : "EQUAL",
              "operands" : [
                "NTO Insider"
              ]
            }
          ]
        }
      },
      "FILTER15" : {
        "action" : "filter",
        "sources" : [
          "LOAD_DATASET19"
        ],
        "parameters" : {
          "filterExpressions" : [
            {
              "type" : "TEXT",
              "field" : "Loyalty_Program",
              "operator" : "EQUAL",
              "operands" : [
                "NTO Insider"
              ]
            }
          ]
        }
      },
      "DISCOVERY_PREDICT0" : {
        "action" : "smartDataDiscoveryPredict",
        "sources" : [
          "FILTER11"
        ],
        "parameters" : {
          "predictSource" : {
            "type" : "PRED_DEF",
            "name" : "Score_Promotion_Influenced_Revenue53"
          },
          "columnMapping" : {
            "Promotion.Start_Date_Week_Month" : "Promotion.Start_Date_Week_Month",
            "Promotion.End_Date_Week_Month" : "Promotion.End_Date_Week_Month",
            "Promotion.Start_Day" : "Promotion.Start_Day",
            "Promotion.Duration" : "Promotion.Duration",
            "Promotion.LoyaltyPromotionType" : "Promotion.LoyaltyPromotionType",
            "Promotion.ProgramCurrency.Name" : "Promotion.ProgramCurrency.Name",
            "Promotion.TotalRewardPoints" : "Promotion.TotalRewardPoints",
            "Promotion.IsEnrollmentRequired" : "Promotion.IsEnrollmentRequired",
            "Promotion.Enrollment_Duration" : "Promotion.Enrollment_Duration",
            "Promotion.MaximumRewardValue" : "Promotion.MaximumRewardValue",
            "Promotion.Partner_Count" : "Promotion.Partner_Count",
            "Promotion.Total_Avg_Partner_Transaction_Amount" : "Promotion.Total_Avg_Partner_Transaction_Amount",
            "Partner_Overlap.Partner_Overlap" : "Partner_Overlap.Partner_Overlap",
            "Promotion.Product_Count" : "Promotion.Product_Count",
            "Promotion.Total_Avg_Product_Transaction_Amount" : "Promotion.Total_Avg_Product_Transaction_Amount",
            "Product_Overlap.Product_Overlap" : "Product_Overlap.Product_Overlap",
            "Members.Membership_Duration" : "Members.Membership_Duration",
            "Members.EnrollmentChannel" : "Members.EnrollmentChannel",
            "Members.Age" : "Members.Age",
            "Members.Member_State_City" : "Members.Member_State_City",
            "Members.Tier.Name" : "Members.Tier.Name",
            "Members.Month_In_Tier" : "Members.Month_In_Tier",
            "Member_Segment.Market_Segment_1" : "Member_Segment.Market_Segment_1",
            "Member_Segment.Market_Segment_2" : "Member_Segment.Market_Segment_2",
            "Member_Segment.Hobby" : "Member_Segment.Hobby",
            "Members.Journal.Accrual_Transaction_Amount" : "Members.Journal.Accrual_Transaction_Amount",
            "Members.MemberCurrency.Ledger.Current_Accrued_Points" : "Members.MemberCurrency.Ledger.Current_Accrued_Points",
            "Members.Journal.Accrual_Transactions_Current_Period" : "Members.Journal.Accrual_Transactions_Current_Period",
            "Members.MemberCurrency.Ledger.Current_Expired_Points" : "Members.MemberCurrency.Ledger.Current_Expired_Points",
            "Members.Journal.DaysBetweenCurrentTransactions" : "Members.Journal.DaysBetweenCurrentTransactions",
            "Members.DaysSinceLastTransaction" : "Members.DaysSinceLastTransaction",
            "Members.Journal.Transactions_all" : "Members.Journal.Transactions_all",
            "Members.Journal.Transaction_Amount_all" : "Members.Journal.Transaction_Amount_all",
            "Members.Average_NQP_Accrued" : "Members.Average_NQP_Accrued",
            "Members.Avg_Transaction_Amount_all" : "Members.Avg_Transaction_Amount_all"
          },
          "predictionField" : {
            "name" : "Maximize_Promotion_Influenced_Revenue_Prediction_1_prediction",
            "label" : "Predicted Promotion_Revenue"
          },
          "predictionFactorFields" : [
            {
              "field" : {
                "name" : "Maximize_Promotion_Influenced_Revenue_Prediction_1_predictor",
                "label" : "Predictor 1"
              },
              "impact" : {
                "name" : "Maximize_Promotion_Influenced_Revenue_Prediction_1_predictor_impact",
                "label" : "Predictor 1 Impact"
              }
            },
            {
              "field" : {
                "name" : "Maximize_Promotion_Influenced_Revenue_Prediction_1_predictor1",
                "label" : "Predictor 2"
              },
              "impact" : {
                "name" : "Maximize_Promotion_Influenced_Revenue_Prediction_1_predictor_impact1",
                "label" : "Predictor 2 Impact"
              }
            },
            {
              "field" : {
                "name" : "Maximize_Promotion_Influenced_Revenue_Prediction_1_predictor2",
                "label" : "Predictor 3"
              },
              "impact" : {
                "name" : "Maximize_Promotion_Influenced_Revenue_Prediction_1_predictor_impact2",
                "label" : "Predictor 3 Impact"
              }
            }
          ],
          "prescriptionFields" : [
            {
              "field" : {
                "name" : "Maximize_Promotion_Influenced_Revenue_Prediction_1_improvement",
                "label" : "Improvement 1"
              },
              "impact" : {
                "name" : "Maximize_Promotion_Influenced_Revenue_Prediction_1_improvement_impact",
                "label" : "Improvement 1 Impact"
              }
            },
            {
              "field" : {
                "name" : "Maximize_Promotion_Influenced_Revenue_Prediction_1_improvement1",
                "label" : "Improvement 2"
              },
              "impact" : {
                "name" : "Maximize_Promotion_Influenced_Revenue_Prediction_1_improvement_impact1",
                "label" : "Improvement 2 Impact"
              }
            },
            {
              "field" : {
                "name" : "Maximize_Promotion_Influenced_Revenue_Prediction_1_improvement2",
                "label" : "Improvement 3"
              },
              "impact" : {
                "name" : "Maximize_Promotion_Influenced_Revenue_Prediction_1_improvement_impact2",
                "label" : "Improvement 3 Impact"
              }
            }
          ]
        }
      },
      "OUTPUT0" : {
        "action" : "save",
        "sources" : [
          "DISCOVERY_PREDICT0"
        ],
        "parameters" : {
          "fields" : [ ],
          "dataset" : {
            "type" : "analyticsDataset",
            "label" : "Promotion Members (Beta)",
            "name" : "${App.Datasets.Promotion_Members59.FullyQualifiedName}",
            "folderName" : "${App.Folder.FullyQualifiedName}"
          }
        }
      },
      "LOAD_DATASET32" : {
        "action" : "load",
        "sources" : [ ],
        "parameters" : {
          "fields" : [
            "Id",
            "Name"
          ],
          "dataset" : {
            "type" : "connectedDataset",
            "label" : "LoyaltyProgramCurrency",
            "connectionName" : "SFDC_LOCAL",
            "sourceObjectName" : "LoyaltyProgramCurrency"
          }
        }
      },
      "JOIN57" : {
        "action" : "join",
        "sources" : [
          "LOAD_DATASET15",
          "LOAD_DATASET32"
        ],
        "schema" : {
          "fields" : [ ],
          "slice" : {
            "mode" : "DROP",
            "ignoreMissingFields" : true,
            "fields" : [
              "PromotionCurrency.Id"
            ]
          }
        },
        "parameters" : {
          "joinType" : "LOOKUP",
          "leftKeys" : [
            "LoyaltyProgramCurrencyId"
          ],
          "rightQualifier" : "PromotionCurrency",
          "rightKeys" : [
            "Id"
          ]
        }
      },
      "FORMULA53" : {
        "action" : "formula",
        "sources" : [
          "FILTER4"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula",
              "label" : "Product_or_Prod_Category_ID",
              "formulaExpression" : "coalesce(ProductId, ProductCategoryId)",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES61" : {
        "action" : "schema",
        "sources" : [
          "FORMULA53"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Product_or_Prod_Category_ID",
                "name" : "Product_or_Prod_Category_ID",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      },
      "FORMULA54" : {
        "action" : "formula",
        "sources" : [
          "LOAD_DATASET18"
        ],
        "parameters" : {
          "expressionType" : "SQL",
          "fields" : [
            {
              "type" : "TEXT",
              "name" : "Id_formula",
              "label" : "Product_or_Prod_Category_ID",
              "formulaExpression" : "coalesce(LoyaltyProductId, ProductCategoryId)",
              "precision" : 255,
              "defaultValue" : ""
            }
          ]
        }
      },
      "EDIT_ATTRIBUTES62" : {
        "action" : "schema",
        "sources" : [
          "FORMULA54"
        ],
        "parameters" : {
          "fields" : [
            {
              "name" : "Id_formula",
              "newProperties" : {
                "label" : "Product_or_Prod_Category_ID",
                "name" : "Product_or_Prod_Category_ID",
                "typeProperties" : {
                  "type" : "TEXT",
                  "length" : 255
                }
              }
            }
          ]
        }
      }
    },
    "ui" : {
      "nodes" : {
        "LOAD_DATASET4" : {
          "label" : "LoyaltyLedger",
          "type" : "LOAD_DATASET",
          "top" : 2912,
          "left" : 1372,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "LOAD_DATASET5" : {
          "label" : "TransactionJournal",
          "type" : "LOAD_DATASET",
          "top" : 3052,
          "left" : 1092,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "LOAD_DATASET6" : {
          "label" : "JournalType",
          "type" : "LOAD_DATASET",
          "top" : 2912,
          "left" : 1092,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "JOIN5" : {
          "label" : "JournalType_Onto_Journal",
          "description" : "",
          "type" : "JOIN",
          "top" : 2912,
          "left" : 1232
        },
        "FILTER0" : {
          "label" : "Filter_Journal",
          "description" : "",
          "type" : "FILTER",
          "top" : 2772,
          "left" : 1372
        },
        "TRANSFORM1" : {
          "label" : "Transform_Journal",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 2912,
          "left" : 1512,
          "graph" : {
            "FORMULA2" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES0" : null,
            "FORMULA3" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES1" : null,
            "FORMULA4" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES2" : null,
            "FORMULA5" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES3" : null,
            "FORMULA6" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES4" : null,
            "FORMULA7" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES5" : null,
            "FORMULA8" : null,
            "EDIT_ATTRIBUTES7" : null,
            "FORMULA9" : null,
            "EDIT_ATTRIBUTES6" : null,
            "FORMULA14" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES13" : null,
            "FORMULA43" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES48" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA2",
              "target" : "EDIT_ATTRIBUTES0"
            },
            {
              "source" : "EDIT_ATTRIBUTES0",
              "target" : "FORMULA3"
            },
            {
              "source" : "FORMULA3",
              "target" : "EDIT_ATTRIBUTES1"
            },
            {
              "source" : "EDIT_ATTRIBUTES1",
              "target" : "FORMULA4"
            },
            {
              "source" : "FORMULA4",
              "target" : "EDIT_ATTRIBUTES2"
            },
            {
              "source" : "EDIT_ATTRIBUTES2",
              "target" : "FORMULA5"
            },
            {
              "source" : "FORMULA5",
              "target" : "EDIT_ATTRIBUTES3"
            },
            {
              "source" : "EDIT_ATTRIBUTES3",
              "target" : "FORMULA6"
            },
            {
              "source" : "EDIT_ATTRIBUTES4",
              "target" : "FORMULA7"
            },
            {
              "source" : "FORMULA7",
              "target" : "EDIT_ATTRIBUTES5"
            },
            {
              "source" : "EDIT_ATTRIBUTES5",
              "target" : "FORMULA8"
            },
            {
              "source" : "FORMULA8",
              "target" : "EDIT_ATTRIBUTES7"
            },
            {
              "source" : "FORMULA9",
              "target" : "EDIT_ATTRIBUTES6"
            },
            {
              "source" : "EDIT_ATTRIBUTES6",
              "target" : "FORMULA14"
            },
            {
              "source" : "FORMULA14",
              "target" : "EDIT_ATTRIBUTES13"
            },
            {
              "source" : "FORMULA43",
              "target" : "EDIT_ATTRIBUTES4"
            },
            {
              "source" : "FORMULA6",
              "target" : "FORMULA43"
            },
            {
              "source" : "EDIT_ATTRIBUTES48",
              "target" : "FORMULA9"
            },
            {
              "source" : "EDIT_ATTRIBUTES7",
              "target" : "EDIT_ATTRIBUTES48"
            }
          ]
        },
        "JOIN7" : {
          "label" : "Journal_Onto_Ledger",
          "description" : "",
          "type" : "JOIN",
          "top" : 3192,
          "left" : 1652
        },
        "TRANSFORM2" : {
          "label" : "Transform_Ledger",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 2912,
          "left" : 1792,
          "graph" : {
            "FORMULA10" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES9" : null,
            "FORMULA11" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES10" : null,
            "FORMULA12" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES11" : null,
            "FORMULA13" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES12" : null,
            "FORMULA47" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES52" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA10",
              "target" : "EDIT_ATTRIBUTES9"
            },
            {
              "source" : "EDIT_ATTRIBUTES9",
              "target" : "FORMULA11"
            },
            {
              "source" : "FORMULA11",
              "target" : "EDIT_ATTRIBUTES10"
            },
            {
              "source" : "EDIT_ATTRIBUTES10",
              "target" : "FORMULA12"
            },
            {
              "source" : "FORMULA12",
              "target" : "EDIT_ATTRIBUTES11"
            },
            {
              "source" : "EDIT_ATTRIBUTES11",
              "target" : "FORMULA13"
            },
            {
              "source" : "FORMULA13",
              "target" : "EDIT_ATTRIBUTES12"
            },
            {
              "source" : "EDIT_ATTRIBUTES12",
              "target" : "FORMULA47"
            },
            {
              "source" : "FORMULA47",
              "target" : "EDIT_ATTRIBUTES52"
            }
          ]
        },
        "LOAD_DATASET8" : {
          "label" : "LoyaltyProgramMember",
          "type" : "LOAD_DATASET",
          "top" : 1652,
          "left" : 1652,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "JOIN12" : {
          "label" : "Ledger_MultiValue_Onto_MemberCurrency",
          "description" : "",
          "type" : "JOIN",
          "top" : 2772,
          "left" : 1932
        },
        "JOIN8" : {
          "label" : "Ledger_Onto_Members",
          "description" : "",
          "type" : "JOIN",
          "top" : 2632,
          "left" : 2072
        },
        "JOIN9" : {
          "label" : "Journal_Onto_Members",
          "description" : "",
          "type" : "JOIN",
          "top" : 2772,
          "left" : 2212
        },
        "JOIN10" : {
          "label" : "Journal_MultiValue_Onto_Members",
          "description" : "",
          "type" : "JOIN",
          "top" : 2632,
          "left" : 2492
        },
        "JOIN11" : {
          "label" : "ProgramCurrency_Onto_MemberCurrency",
          "description" : "",
          "type" : "JOIN",
          "top" : 2632,
          "left" : 1652
        },
        "LOAD_DATASET9" : {
          "label" : "LoyaltyMemberCurrency",
          "description" : "",
          "type" : "LOAD_DATASET",
          "top" : 2352,
          "left" : 1372,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "FILTER1" : {
          "label" : "Filter_Currency",
          "description" : "",
          "type" : "FILTER",
          "top" : 3052,
          "left" : 1792
        },
        "LOAD_DATASET10" : {
          "label" : "LoyaltyProgramCurrency",
          "type" : "LOAD_DATASET",
          "top" : 2352,
          "left" : 1512,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "LOAD_DATASET11" : {
          "label" : "LoyaltyProgram",
          "type" : "LOAD_DATASET",
          "top" : 2072,
          "left" : 1652,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "JOIN13" : {
          "label" : "Program_Onto_Members",
          "description" : "",
          "type" : "JOIN",
          "top" : 2632,
          "left" : 1792
        },
        "JOIN14" : {
          "label" : "Journal_MultiValue_Onto_Partners",
          "description" : "",
          "type" : "JOIN",
          "top" : 2212,
          "left" : 1792
        },
        "JOIN15" : {
          "label" : "Journal_MultiValue_Onto_Products",
          "description" : "",
          "type" : "JOIN",
          "top" : 2492,
          "left" : 1792
        },
        "JOIN16" : {
          "label" : "Journal_MultiValue_Onto_ProductCategories",
          "description" : "",
          "type" : "JOIN",
          "top" : 2772,
          "left" : 1652
        },
        "FILTER2" : {
          "label" : "Filter_Members",
          "type" : "FILTER",
          "top" : 2072,
          "left" : 1932
        },
        "LOAD_DATASET12" : {
          "label" : "LoyaltyProgramPartner",
          "type" : "LOAD_DATASET",
          "top" : 2212,
          "left" : 1372,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "LOAD_DATASET13" : {
          "label" : "Product2",
          "type" : "LOAD_DATASET",
          "top" : 2212,
          "left" : 1092,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "LOAD_DATASET14" : {
          "label" : "ProductCategory",
          "type" : "LOAD_DATASET",
          "top" : 2352,
          "left" : 1092,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "LOAD_DATASET17" : {
          "label" : "LoyaltyProgram",
          "type" : "LOAD_DATASET",
          "top" : 1792,
          "left" : 1092,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "JOIN17" : {
          "label" : "Join",
          "type" : "JOIN",
          "top" : 1932,
          "left" : 1232
        },
        "TRANSFORM3" : {
          "label" : "Transform_Promotions",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 1932,
          "left" : 1372,
          "graph" : {
            "FORMULA16" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES15" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA16",
              "target" : "EDIT_ATTRIBUTES15"
            }
          ]
        },
        "FILTER3" : {
          "label" : "Filter_Scoring_Promotions",
          "description" : "",
          "type" : "FILTER",
          "top" : 1932,
          "left" : 1652
        },
        "LOAD_DATASET15" : {
          "label" : "Promotion",
          "description" : "",
          "type" : "LOAD_DATASET",
          "top" : 1932,
          "left" : 812,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "LOAD_DATASET16" : {
          "label" : "Members_For_Scoring",
          "description" : "",
          "type" : "LOAD_DATASET",
          "top" : 2072,
          "left" : 1092,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "JOIN18" : {
          "label" : "Members_CrossJoin_Onto_Promotions",
          "description" : "",
          "type" : "JOIN",
          "top" : 1932,
          "left" : 1932
        },
        "LOAD_DATASET18" : {
          "label" : "PromotionLoyaltyPtnrProdt",
          "type" : "LOAD_DATASET",
          "top" : 2212,
          "left" : 2072,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "FILTER4" : {
          "label" : "Filter_Current_Transactions_for_overlap",
          "description" : "",
          "type" : "FILTER",
          "top" : 1932,
          "left" : 2212
        },
        "JOIN19" : {
          "label" : "Member_Promo_ParnterOverlap",
          "description" : "",
          "type" : "JOIN",
          "top" : 2212,
          "left" : 2492
        },
        "JOIN20" : {
          "label" : "Member_Promo_ProductOverlap",
          "description" : "",
          "type" : "JOIN",
          "top" : 2352,
          "left" : 2492
        },
        "JOIN21" : {
          "label" : "Member_Promo_ProductCategoryOverlap",
          "description" : "",
          "type" : "JOIN",
          "top" : 2492,
          "left" : 2492
        },
        "TRANSFORM4" : {
          "label" : "Transform_CountOfOverlappingPartners",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 2212,
          "left" : 2632,
          "graph" : {
            "FORMULA17" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES16" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA17",
              "target" : "EDIT_ATTRIBUTES16"
            }
          ]
        },
        "TRANSFORM5" : {
          "label" : "Transform_CountOfOverlappingProducts",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 2492,
          "left" : 2772,
          "graph" : {
            "FORMULA27" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES26" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA27",
              "target" : "EDIT_ATTRIBUTES26"
            }
          ]
        },
        "TRANSFORM6" : {
          "label" : "Transform_CountOfOverlappingProductCategories",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 2352,
          "left" : 2632,
          "graph" : {
            "FORMULA19" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES17" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA19",
              "target" : "EDIT_ATTRIBUTES17"
            }
          ]
        },
        "JOIN22" : {
          "label" : "Member_details_onto_Scoring",
          "description" : "",
          "type" : "JOIN",
          "top" : 2772,
          "left" : 4312
        },
        "TRANSFORM7" : {
          "label" : "Transform_Partners_Count_and_Amounts",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 2212,
          "left" : 1932,
          "graph" : {
            "FORMULA20" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES19" : null,
            "FORMULA21" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES20" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA20",
              "target" : "EDIT_ATTRIBUTES19"
            },
            {
              "source" : "EDIT_ATTRIBUTES19",
              "target" : "FORMULA21"
            },
            {
              "source" : "FORMULA21",
              "target" : "EDIT_ATTRIBUTES20"
            }
          ]
        },
        "TRANSFORM8" : {
          "label" : "Transform_Products_Count_and_Amounts",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 2352,
          "left" : 1932,
          "graph" : {
            "FORMULA22" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES21" : null,
            "FORMULA23" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES22" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA22",
              "target" : "EDIT_ATTRIBUTES21"
            },
            {
              "source" : "EDIT_ATTRIBUTES21",
              "target" : "FORMULA23"
            },
            {
              "source" : "FORMULA23",
              "target" : "EDIT_ATTRIBUTES22"
            }
          ]
        },
        "TRANSFORM9" : {
          "label" : "Transform_ProductCategories_Count_and_Amounts",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 2912,
          "left" : 1932,
          "graph" : {
            "FORMULA24" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES23" : null,
            "FORMULA25" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES24" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA24",
              "target" : "EDIT_ATTRIBUTES23"
            },
            {
              "source" : "EDIT_ATTRIBUTES23",
              "target" : "FORMULA25"
            },
            {
              "source" : "FORMULA25",
              "target" : "EDIT_ATTRIBUTES24"
            }
          ]
        },
        "LOAD_DATASET19" : {
          "label" : "Members_Targeted",
          "description" : "",
          "type" : "LOAD_DATASET",
          "top" : 2492,
          "left" : 1092,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "LOAD_DATASET20" : {
          "label" : "Member_Segments",
          "description" : "",
          "type" : "LOAD_DATASET",
          "top" : 2632,
          "left" : 1092,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "JOIN23" : {
          "label" : "Segments_Onto_MembersTargeted",
          "description" : "",
          "type" : "JOIN",
          "top" : 2492,
          "left" : 1372
        },
        "LOAD_DATASET21" : {
          "label" : "LoyaltyProgramMember",
          "type" : "LOAD_DATASET",
          "top" : 2772,
          "left" : 1092,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "JOIN24" : {
          "label" : "Members_Onto_MembersTargeted",
          "description" : "",
          "type" : "JOIN",
          "top" : 2492,
          "left" : 1932
        },
        "JOIN25" : {
          "label" : "Member_details_Onto_Training",
          "description" : "",
          "type" : "JOIN",
          "top" : 2632,
          "left" : 4312
        },
        "LOAD_DATASET22" : {
          "label" : "PromotionLoyaltyPtnrProdt",
          "type" : "LOAD_DATASET",
          "top" : 1792,
          "left" : 2072,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "AGGREGATE0" : {
          "label" : "Promotion_Partner",
          "description" : "",
          "type" : "AGGREGATE",
          "top" : 2352,
          "left" : 2212,
          "graph" : {
            "EXTRACT0" : null,
            "AGGREGATE1" : null
          },
          "connectors" : [
            {
              "source" : "EXTRACT0",
              "target" : "AGGREGATE1"
            }
          ]
        },
        "AGGREGATE2" : {
          "label" : "Member_Partner",
          "description" : "",
          "type" : "AGGREGATE",
          "top" : 1792,
          "left" : 2352,
          "graph" : {
            "EXTRACT1" : null,
            "AGGREGATE3" : null
          },
          "connectors" : [
            {
              "source" : "EXTRACT1",
              "target" : "AGGREGATE3"
            }
          ]
        },
        "AGGREGATE4" : {
          "label" : "Member_Partner_Overlapping_Ratio",
          "description" : "",
          "type" : "AGGREGATE",
          "top" : 2212,
          "left" : 2772,
          "graph" : {
            "EXTRACT2" : null,
            "AGGREGATE5" : null
          },
          "connectors" : [
            {
              "source" : "EXTRACT2",
              "target" : "AGGREGATE5"
            }
          ]
        },
        "TRANSFORM10" : {
          "label" : "Transform_Partner_Overlap",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 2212,
          "left" : 2912,
          "graph" : {
            "FORMULA26" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES58" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA26",
              "target" : "EDIT_ATTRIBUTES58"
            }
          ]
        },
        "AGGREGATE6" : {
          "label" : "Promotion_Product",
          "description" : "",
          "type" : "AGGREGATE",
          "top" : 2492,
          "left" : 2352,
          "graph" : {
            "EXTRACT3" : null,
            "AGGREGATE7" : null
          },
          "connectors" : [
            {
              "source" : "EXTRACT3",
              "target" : "AGGREGATE7"
            }
          ]
        },
        "AGGREGATE8" : {
          "label" : "Member_Product",
          "description" : "",
          "type" : "AGGREGATE",
          "top" : 1932,
          "left" : 2352,
          "graph" : {
            "EXTRACT4" : null,
            "AGGREGATE9" : null
          },
          "connectors" : [
            {
              "source" : "EXTRACT4",
              "target" : "AGGREGATE9"
            }
          ]
        },
        "AGGREGATE10" : {
          "label" : "Member_Product_Overlapping_Ratio",
          "description" : "",
          "type" : "AGGREGATE",
          "top" : 2492,
          "left" : 2912,
          "graph" : {
            "EXTRACT5" : null,
            "AGGREGATE11" : null
          },
          "connectors" : [
            {
              "source" : "EXTRACT5",
              "target" : "AGGREGATE11"
            }
          ]
        },
        "TRANSFORM11" : {
          "label" : "Transform_Product_Overlap",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 2492,
          "left" : 3052,
          "graph" : {
            "FORMULA28" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES60" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA28",
              "target" : "EDIT_ATTRIBUTES60"
            }
          ]
        },
        "AGGREGATE12" : {
          "label" : "Promotion_ProductCategory",
          "description" : "",
          "type" : "AGGREGATE",
          "top" : 2632,
          "left" : 2352,
          "graph" : {
            "EXTRACT6" : null,
            "AGGREGATE13" : null
          },
          "connectors" : [
            {
              "source" : "EXTRACT6",
              "target" : "AGGREGATE13"
            }
          ]
        },
        "AGGREGATE14" : {
          "label" : "Member_ProductCategory",
          "description" : "",
          "type" : "AGGREGATE",
          "top" : 2352,
          "left" : 2352,
          "graph" : {
            "EXTRACT7" : null,
            "AGGREGATE15" : null
          },
          "connectors" : [
            {
              "source" : "EXTRACT7",
              "target" : "AGGREGATE15"
            }
          ]
        },
        "AGGREGATE16" : {
          "label" : "Member_ProductCategory_Overlapping_Ratio",
          "description" : "",
          "type" : "AGGREGATE",
          "top" : 2352,
          "left" : 2772,
          "graph" : {
            "EXTRACT8" : null,
            "AGGREGATE17" : null
          },
          "connectors" : [
            {
              "source" : "EXTRACT8",
              "target" : "AGGREGATE17"
            }
          ]
        },
        "TRANSFORM12" : {
          "label" : "Transform_ProductCategory_Overlap",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 2352,
          "left" : 2912,
          "graph" : {
            "FORMULA29" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES59" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA29",
              "target" : "EDIT_ATTRIBUTES59"
            }
          ]
        },
        "JOIN29" : {
          "label" : "Promotion_Member_Overlap_Partner",
          "description" : "",
          "type" : "JOIN",
          "top" : 2212,
          "left" : 3472
        },
        "JOIN30" : {
          "label" : "Promotion_Member_Overlap_Product",
          "description" : "",
          "type" : "JOIN",
          "top" : 2212,
          "left" : 3612
        },
        "JOIN31" : {
          "label" : "Promotion_Member_Overlap_ProductCategory",
          "description" : "",
          "type" : "JOIN",
          "top" : 2212,
          "left" : 3752
        },
        "JOIN32" : {
          "label" : "Promotion_Member_Overlap_Partner_Training",
          "description" : "",
          "type" : "JOIN",
          "top" : 2212,
          "left" : 3192
        },
        "JOIN33" : {
          "label" : "Promotion_Member_Overlap_Product_Training",
          "description" : "",
          "type" : "JOIN",
          "top" : 2212,
          "left" : 3332
        },
        "JOIN34" : {
          "label" : "Promotion_Member_Overlap_ProductCategory_Training",
          "description" : "",
          "type" : "JOIN",
          "top" : 2352,
          "left" : 3472
        },
        "JOIN35" : {
          "label" : "Segments_Onto_MemberPromotions",
          "description" : "",
          "type" : "JOIN",
          "top" : 2212,
          "left" : 3052
        },
        "AGGREGATE18" : {
          "label" : "Promotion_Partner_2",
          "description" : "",
          "type" : "AGGREGATE",
          "top" : 1792,
          "left" : 2212,
          "graph" : {
            "EXTRACT9" : null,
            "AGGREGATE19" : null
          },
          "connectors" : [
            {
              "source" : "EXTRACT9",
              "target" : "AGGREGATE19"
            }
          ]
        },
        "JOIN36" : {
          "label" : "Aggregated_Partner_Transactions_Onto_Promo",
          "description" : "",
          "type" : "JOIN",
          "top" : 1652,
          "left" : 2352
        },
        "AGGREGATE20" : {
          "label" : "Promo_Avg_Parnters_and_Transaction_Amounts",
          "description" : "",
          "type" : "AGGREGATE",
          "top" : 1792,
          "left" : 2492,
          "graph" : {
            "EXTRACT10" : null,
            "AGGREGATE21" : null
          },
          "connectors" : [
            {
              "source" : "EXTRACT10",
              "target" : "AGGREGATE21"
            }
          ]
        },
        "AGGREGATE22" : {
          "label" : "Promotion_Product_2",
          "description" : "",
          "type" : "AGGREGATE",
          "top" : 1932,
          "left" : 2492,
          "graph" : {
            "EXTRACT11" : null,
            "AGGREGATE23" : null
          },
          "connectors" : [
            {
              "source" : "EXTRACT11",
              "target" : "AGGREGATE23"
            }
          ]
        },
        "JOIN37" : {
          "label" : "Aggregated_Product_Transactions_Onto_Promo",
          "description" : "",
          "type" : "JOIN",
          "top" : 1932,
          "left" : 2632
        },
        "AGGREGATE24" : {
          "label" : "Promo_Avg_Product_and_Transaction_Amounts",
          "description" : "",
          "type" : "AGGREGATE",
          "top" : 1932,
          "left" : 2772,
          "graph" : {
            "EXTRACT12" : null,
            "AGGREGATE25" : null
          },
          "connectors" : [
            {
              "source" : "EXTRACT12",
              "target" : "AGGREGATE25"
            }
          ]
        },
        "AGGREGATE26" : {
          "label" : "Promotion_ProductCategory_2",
          "description" : "",
          "type" : "AGGREGATE",
          "top" : 2212,
          "left" : 2212,
          "graph" : {
            "EXTRACT13" : null,
            "AGGREGATE27" : null
          },
          "connectors" : [
            {
              "source" : "EXTRACT13",
              "target" : "AGGREGATE27"
            }
          ]
        },
        "JOIN38" : {
          "label" : "Aggregated_ProductCategory_Transactions_Onto_Promo",
          "description" : "",
          "type" : "JOIN",
          "top" : 2212,
          "left" : 2352
        },
        "AGGREGATE28" : {
          "label" : "Promo_Avg_ProductCategory_and_Transaction_Amounts",
          "description" : "",
          "type" : "AGGREGATE",
          "top" : 2072,
          "left" : 2492,
          "graph" : {
            "EXTRACT14" : null,
            "AGGREGATE29" : null
          },
          "connectors" : [
            {
              "source" : "EXTRACT14",
              "target" : "AGGREGATE29"
            }
          ]
        },
        "LOAD_DATASET23" : {
          "label" : "Promotion",
          "type" : "LOAD_DATASET",
          "top" : 1792,
          "left" : 2632,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "JOIN39" : {
          "label" : "Partner_Averages",
          "description" : "",
          "type" : "JOIN",
          "top" : 1792,
          "left" : 2772
        },
        "JOIN40" : {
          "label" : "Product_Averages",
          "description" : "",
          "type" : "JOIN",
          "top" : 1932,
          "left" : 2912
        },
        "JOIN41" : {
          "label" : "ProductCategory_Averages",
          "description" : "",
          "type" : "JOIN",
          "top" : 1932,
          "left" : 3052
        },
        "TRANSFORM13" : {
          "label" : "Transform_Promotions",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 1932,
          "left" : 4032,
          "graph" : {
            "EDIT_ATTRIBUTES29" : null,
            "EDIT_ATTRIBUTES30" : null,
            "EDIT_ATTRIBUTES31" : null,
            "EDIT_ATTRIBUTES32" : null,
            "EDIT_ATTRIBUTES33" : null,
            "EDIT_ATTRIBUTES34" : null,
            "FORMULA30" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES35" : null,
            "FORMULA31" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES36" : null,
            "FORMULA32" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES37" : null,
            "FORMULA33" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES38" : null,
            "FORMULA48" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES53" : null,
            "FORMULA55" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES63" : null,
            "FORMULA56" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES64" : null
          },
          "connectors" : [
            {
              "source" : "EDIT_ATTRIBUTES29",
              "target" : "EDIT_ATTRIBUTES30"
            },
            {
              "source" : "EDIT_ATTRIBUTES30",
              "target" : "EDIT_ATTRIBUTES31"
            },
            {
              "source" : "EDIT_ATTRIBUTES31",
              "target" : "EDIT_ATTRIBUTES32"
            },
            {
              "source" : "EDIT_ATTRIBUTES32",
              "target" : "EDIT_ATTRIBUTES33"
            },
            {
              "source" : "EDIT_ATTRIBUTES33",
              "target" : "EDIT_ATTRIBUTES34"
            },
            {
              "source" : "EDIT_ATTRIBUTES34",
              "target" : "FORMULA30"
            },
            {
              "source" : "FORMULA30",
              "target" : "EDIT_ATTRIBUTES35"
            },
            {
              "source" : "EDIT_ATTRIBUTES35",
              "target" : "FORMULA31"
            },
            {
              "source" : "FORMULA32",
              "target" : "EDIT_ATTRIBUTES36"
            },
            {
              "source" : "FORMULA31",
              "target" : "FORMULA32"
            },
            {
              "source" : "EDIT_ATTRIBUTES36",
              "target" : "EDIT_ATTRIBUTES37"
            },
            {
              "source" : "EDIT_ATTRIBUTES37",
              "target" : "FORMULA33"
            },
            {
              "source" : "FORMULA33",
              "target" : "EDIT_ATTRIBUTES38"
            },
            {
              "source" : "EDIT_ATTRIBUTES38",
              "target" : "FORMULA48"
            },
            {
              "source" : "FORMULA48",
              "target" : "EDIT_ATTRIBUTES53"
            },
            {
              "source" : "EDIT_ATTRIBUTES53",
              "target" : "FORMULA55"
            },
            {
              "source" : "FORMULA55",
              "target" : "EDIT_ATTRIBUTES63"
            },
            {
              "source" : "EDIT_ATTRIBUTES63",
              "target" : "FORMULA56"
            },
            {
              "source" : "FORMULA56",
              "target" : "EDIT_ATTRIBUTES64"
            }
          ]
        },
        "LOAD_DATASET24" : {
          "label" : "PromotionMarketSegment",
          "type" : "LOAD_DATASET",
          "top" : 1652,
          "left" : 812,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "JOIN42" : {
          "label" : "MarketSegment_Onto_PromotionMarketSegment",
          "description" : "",
          "type" : "JOIN",
          "top" : 1652,
          "left" : 952
        },
        "LOAD_DATASET25" : {
          "label" : "MarketSegment",
          "type" : "LOAD_DATASET",
          "top" : 1792,
          "left" : 812,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "TRANSFORM14" : {
          "label" : "Transform_Five_Market_Segments",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 1652,
          "left" : 1092,
          "graph" : {
            "FORMULA34" : null,
            "EDIT_ATTRIBUTES39" : null,
            "FORMULA35" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "FORMULA36" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "FORMULA37" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "FORMULA38" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "FORMULA39" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES40" : null,
            "EDIT_ATTRIBUTES41" : null,
            "EDIT_ATTRIBUTES42" : null,
            "EDIT_ATTRIBUTES43" : null,
            "EDIT_ATTRIBUTES44" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA34",
              "target" : "EDIT_ATTRIBUTES39"
            },
            {
              "source" : "EDIT_ATTRIBUTES39",
              "target" : "FORMULA35"
            },
            {
              "source" : "FORMULA35",
              "target" : "FORMULA36"
            },
            {
              "source" : "FORMULA36",
              "target" : "FORMULA37"
            },
            {
              "source" : "FORMULA37",
              "target" : "FORMULA38"
            },
            {
              "source" : "FORMULA38",
              "target" : "FORMULA39"
            },
            {
              "source" : "FORMULA39",
              "target" : "EDIT_ATTRIBUTES40"
            },
            {
              "source" : "EDIT_ATTRIBUTES40",
              "target" : "EDIT_ATTRIBUTES41"
            },
            {
              "source" : "EDIT_ATTRIBUTES41",
              "target" : "EDIT_ATTRIBUTES42"
            },
            {
              "source" : "EDIT_ATTRIBUTES42",
              "target" : "EDIT_ATTRIBUTES43"
            },
            {
              "source" : "EDIT_ATTRIBUTES43",
              "target" : "EDIT_ATTRIBUTES44"
            }
          ]
        },
        "FILTER5" : {
          "label" : "Promotion_Market_Segment_1",
          "description" : "",
          "type" : "FILTER",
          "top" : 1232,
          "left" : 1232
        },
        "FILTER6" : {
          "label" : "Promotion_Market_Segment_2",
          "description" : "",
          "type" : "FILTER",
          "top" : 1372,
          "left" : 1232
        },
        "FILTER7" : {
          "label" : "Promotion_Market_Segment_3",
          "description" : "",
          "type" : "FILTER",
          "top" : 1512,
          "left" : 1232
        },
        "FILTER8" : {
          "label" : "Promotion_Market_Segment_4",
          "description" : "",
          "type" : "FILTER",
          "top" : 1652,
          "left" : 1232
        },
        "FILTER9" : {
          "label" : "Promotion_Market_Segment_5",
          "description" : "",
          "type" : "FILTER",
          "top" : 1792,
          "left" : 1232
        },
        "JOIN43" : {
          "label" : "Market_Segment_1_Onto_Promotion",
          "description" : "",
          "type" : "JOIN",
          "top" : 1932,
          "left" : 3332
        },
        "JOIN44" : {
          "label" : "Market_Segment_2_Onto_Promotion",
          "description" : "",
          "type" : "JOIN",
          "top" : 1932,
          "left" : 3472
        },
        "JOIN45" : {
          "label" : "Market_Segment_3_Onto_Promotion",
          "description" : "",
          "type" : "JOIN",
          "top" : 1932,
          "left" : 3612
        },
        "JOIN46" : {
          "label" : "Market_Segment_4_Onto_Promotion",
          "description" : "",
          "type" : "JOIN",
          "top" : 1932,
          "left" : 3752
        },
        "JOIN47" : {
          "label" : "Market_Segment_5_Onto_Promotion",
          "description" : "",
          "type" : "JOIN",
          "top" : 1932,
          "left" : 3892
        },
        "LOAD_DATASET26" : {
          "label" : "LoyaltyProgramCurrency",
          "type" : "LOAD_DATASET",
          "top" : 1652,
          "left" : 3052,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "JOIN48" : {
          "label" : "Currency_Onto_Promotion",
          "description" : "",
          "type" : "JOIN",
          "top" : 1932,
          "left" : 3192
        },
        "JOIN49" : {
          "label" : "Promotion_Features_Onto_Scoring",
          "description" : "",
          "type" : "JOIN",
          "top" : 1932,
          "left" : 4172
        },
        "JOIN50" : {
          "label" : "Promotion_Features_Onto_Training",
          "description" : "",
          "type" : "JOIN",
          "top" : 2072,
          "left" : 4172
        },
        "TRANSFORM15" : {
          "label" : "Transform_Members",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 2772,
          "left" : 3052,
          "graph" : {
            "FORMULA40" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES45" : null,
            "FORMULA44" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES49" : null,
            "FORMULA49" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES54" : null,
            "FORMULA50" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES55" : null,
            "FORMULA51" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES56" : null,
            "FORMULA52" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES57" : null,
            "FORMULA57" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES65" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA40",
              "target" : "EDIT_ATTRIBUTES45"
            },
            {
              "source" : "EDIT_ATTRIBUTES45",
              "target" : "FORMULA44"
            },
            {
              "source" : "FORMULA44",
              "target" : "EDIT_ATTRIBUTES49"
            },
            {
              "source" : "EDIT_ATTRIBUTES49",
              "target" : "FORMULA49"
            },
            {
              "source" : "FORMULA49",
              "target" : "EDIT_ATTRIBUTES54"
            },
            {
              "source" : "EDIT_ATTRIBUTES54",
              "target" : "FORMULA50"
            },
            {
              "source" : "FORMULA50",
              "target" : "EDIT_ATTRIBUTES55"
            },
            {
              "source" : "EDIT_ATTRIBUTES55",
              "target" : "FORMULA51"
            },
            {
              "source" : "FORMULA51",
              "target" : "EDIT_ATTRIBUTES56"
            },
            {
              "source" : "EDIT_ATTRIBUTES56",
              "target" : "FORMULA52"
            },
            {
              "source" : "FORMULA52",
              "target" : "EDIT_ATTRIBUTES57"
            },
            {
              "source" : "EDIT_ATTRIBUTES57",
              "target" : "FORMULA57"
            },
            {
              "source" : "FORMULA57",
              "target" : "EDIT_ATTRIBUTES65"
            }
          ]
        },
        "LOAD_DATASET27" : {
          "label" : "LoyaltyTierGroup",
          "type" : "LOAD_DATASET",
          "top" : 3192,
          "left" : 1932,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "LOAD_DATASET28" : {
          "label" : "LoyaltyMemberTier",
          "type" : "LOAD_DATASET",
          "top" : 3052,
          "left" : 2212,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "TRANSFORM16" : {
          "label" : "Transform_TierGroup",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 3052,
          "left" : 2072,
          "graph" : {
            "FORMULA41" : null,
            "EDIT_ATTRIBUTES46" : null,
            "FORMULA42" : null,
            "EDIT_ATTRIBUTES47" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA42",
              "target" : "EDIT_ATTRIBUTES46"
            },
            {
              "source" : "FORMULA41",
              "target" : "FORMULA42"
            },
            {
              "source" : "EDIT_ATTRIBUTES46",
              "target" : "EDIT_ATTRIBUTES47"
            }
          ]
        },
        "AGGREGATE30" : {
          "label" : "Aggregate",
          "type" : "AGGREGATE",
          "top" : 2912,
          "left" : 2212,
          "graph" : {
            "EXTRACT15" : null,
            "AGGREGATE31" : null
          },
          "connectors" : [
            {
              "source" : "EXTRACT15",
              "target" : "AGGREGATE31"
            }
          ]
        },
        "JOIN51" : {
          "label" : "Selected_Tier_Group_Onto_Tier",
          "description" : "",
          "type" : "JOIN",
          "top" : 3052,
          "left" : 2352
        },
        "FILTER10" : {
          "label" : "Filte_Tiers_from_Selected_TierGroup",
          "description" : "",
          "type" : "FILTER",
          "top" : 3052,
          "left" : 2492
        },
        "JOIN52" : {
          "label" : "Tier_Onto_Members",
          "description" : "",
          "type" : "JOIN",
          "top" : 2632,
          "left" : 2912
        },
        "LOAD_DATASET29" : {
          "label" : "Contact",
          "type" : "LOAD_DATASET",
          "top" : 2912,
          "left" : 2492,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "JOIN53" : {
          "label" : "Contact_Onto_Members",
          "description" : "",
          "type" : "JOIN",
          "top" : 2772,
          "left" : 2632
        },
        "LOAD_DATASET30" : {
          "label" : "Account",
          "type" : "LOAD_DATASET",
          "top" : 2912,
          "left" : 2632,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "JOIN54" : {
          "label" : "Account_Onto_Members",
          "description" : "",
          "type" : "JOIN",
          "top" : 2772,
          "left" : 2772
        },
        "APPEND0" : {
          "label" : "Append_Training_Scoring",
          "description" : "",
          "type" : "APPEND",
          "top" : 2772,
          "left" : 4592
        },
        "TRANSFORM17" : {
          "label" : "Transform_Training_Filter",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 2632,
          "left" : 4452,
          "graph" : {
            "FORMULA45" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES50" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA45",
              "target" : "EDIT_ATTRIBUTES50"
            }
          ]
        },
        "TRANSFORM18" : {
          "label" : "Transform_Scoring_Filter",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 2772,
          "left" : 4452,
          "graph" : {
            "FORMULA46" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES51" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA46",
              "target" : "EDIT_ATTRIBUTES51"
            }
          ]
        },
        "FILTER11" : {
          "label" : "Filter_Training_Scoring",
          "description" : "",
          "type" : "FILTER",
          "top" : 2632,
          "left" : 4732
        },
        "FILTER12" : {
          "label" : "Filter_Training_Promotions",
          "description" : "",
          "type" : "FILTER",
          "top" : 2212,
          "left" : 1512
        },
        "JOIN55" : {
          "label" : "Promotions_Onto_MembersTargeted",
          "description" : "",
          "type" : "JOIN",
          "top" : 2352,
          "left" : 1652
        },
        "FILTER13" : {
          "label" : "Filter_Promotions_With_EndDate",
          "description" : "",
          "type" : "FILTER",
          "top" : 2492,
          "left" : 1652
        },
        "LOAD_DATASET31" : {
          "label" : "LoyaltyProgram",
          "type" : "LOAD_DATASET",
          "top" : 2072,
          "left" : 952,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "JOIN56" : {
          "label" : "Prog_Onto_scoring_Members",
          "description" : "",
          "type" : "JOIN",
          "top" : 2072,
          "left" : 1232
        },
        "FILTER14" : {
          "label" : "Filter_Members_By_Program",
          "description" : "",
          "type" : "FILTER",
          "top" : 2072,
          "left" : 1372
        },
        "FILTER15" : {
          "label" : "Filter_Members_Targeted_By_Program",
          "description" : "",
          "type" : "FILTER",
          "top" : 2492,
          "left" : 1232
        },
        "DISCOVERY_PREDICT0" : {
          "label" : "Discovery Predict",
          "type" : "DISCOVERY_PREDICT",
          "top" : 2772,
          "left" : 4872
        },
        "OUTPUT0" : {
          "label" : "Output",
          "type" : "OUTPUT",
          "top" : 2772,
          "left" : 5012
        },
        "LOAD_DATASET32" : {
          "label" : "LoyaltyProgramCurrency",
          "type" : "LOAD_DATASET",
          "top" : 1792,
          "left" : 952,
          "parameters" : {
            "sampleSize" : 2000
          }
        },
        "JOIN57" : {
          "label" : "ProgramCurrency_Onto_Promotion",
          "description" : "",
          "type" : "JOIN",
          "top" : 1932,
          "left" : 1092
        },
        "TRANSFORM19" : {
          "label" : "Transform_Product_or_Prod_Category_ID_for_Transactions",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 2072,
          "left" : 2352,
          "graph" : {
            "FORMULA53" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES61" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA53",
              "target" : "EDIT_ATTRIBUTES61"
            }
          ]
        },
        "TRANSFORM20" : {
          "label" : "Transform_Product_or_Prod_Category_ID_for_PromoProd",
          "description" : "",
          "type" : "TRANSFORM",
          "top" : 2492,
          "left" : 2212,
          "graph" : {
            "FORMULA54" : {
              "parameters" : {
                "type" : "BASE_FORMULA_UI"
              }
            },
            "EDIT_ATTRIBUTES62" : null
          },
          "connectors" : [
            {
              "source" : "FORMULA54",
              "target" : "EDIT_ATTRIBUTES62"
            }
          ]
        }
      },
      "connectors" : [
        {
          "source" : "LOAD_DATASET4",
          "target" : "JOIN7"
        },
        {
          "source" : "JOIN57",
          "target" : "JOIN17"
        },
        {
          "source" : "LOAD_DATASET5",
          "target" : "JOIN5"
        },
        {
          "source" : "LOAD_DATASET6",
          "target" : "JOIN5"
        },
        {
          "source" : "JOIN5",
          "target" : "FILTER0"
        },
        {
          "source" : "FILTER0",
          "target" : "TRANSFORM1"
        },
        {
          "source" : "TRANSFORM1",
          "target" : "JOIN7"
        },
        {
          "source" : "JOIN7",
          "target" : "TRANSFORM2"
        },
        {
          "source" : "FILTER1",
          "target" : "JOIN12"
        },
        {
          "source" : "TRANSFORM2",
          "target" : "JOIN12"
        },
        {
          "source" : "FILTER2",
          "target" : "JOIN8"
        },
        {
          "source" : "JOIN12",
          "target" : "JOIN8"
        },
        {
          "source" : "JOIN8",
          "target" : "JOIN9"
        },
        {
          "source" : "TRANSFORM1",
          "target" : "JOIN9"
        },
        {
          "source" : "JOIN9",
          "target" : "JOIN10"
        },
        {
          "source" : "TRANSFORM1",
          "target" : "JOIN10"
        },
        {
          "source" : "LOAD_DATASET9",
          "target" : "JOIN11"
        },
        {
          "source" : "LOAD_DATASET10",
          "target" : "JOIN11"
        },
        {
          "source" : "JOIN11",
          "target" : "FILTER1"
        },
        {
          "source" : "LOAD_DATASET8",
          "target" : "JOIN13"
        },
        {
          "source" : "LOAD_DATASET11",
          "target" : "JOIN13"
        },
        {
          "source" : "JOIN13",
          "target" : "FILTER2"
        },
        {
          "source" : "LOAD_DATASET12",
          "target" : "JOIN14"
        },
        {
          "source" : "TRANSFORM1",
          "target" : "JOIN14"
        },
        {
          "source" : "LOAD_DATASET13",
          "target" : "JOIN15"
        },
        {
          "source" : "TRANSFORM1",
          "target" : "JOIN15"
        },
        {
          "source" : "LOAD_DATASET14",
          "target" : "JOIN16"
        },
        {
          "source" : "TRANSFORM1",
          "target" : "JOIN16"
        },
        {
          "source" : "LOAD_DATASET17",
          "target" : "JOIN17"
        },
        {
          "source" : "JOIN17",
          "target" : "TRANSFORM3"
        },
        {
          "source" : "TRANSFORM3",
          "target" : "FILTER3"
        },
        {
          "source" : "FILTER3",
          "target" : "JOIN18"
        },
        {
          "source" : "FILTER14",
          "target" : "JOIN18"
        },
        {
          "source" : "TRANSFORM1",
          "target" : "FILTER4"
        },
        {
          "source" : "AGGREGATE0",
          "target" : "JOIN19"
        },
        {
          "source" : "JOIN19",
          "target" : "TRANSFORM4"
        },
        {
          "source" : "AGGREGATE6",
          "target" : "JOIN20"
        },
        {
          "source" : "AGGREGATE8",
          "target" : "JOIN20"
        },
        {
          "source" : "JOIN20",
          "target" : "TRANSFORM5"
        },
        {
          "source" : "AGGREGATE12",
          "target" : "JOIN21"
        },
        {
          "source" : "AGGREGATE14",
          "target" : "JOIN21"
        },
        {
          "source" : "JOIN21",
          "target" : "TRANSFORM6"
        },
        {
          "source" : "JOIN49",
          "target" : "JOIN22"
        },
        {
          "source" : "TRANSFORM15",
          "target" : "JOIN22"
        },
        {
          "source" : "JOIN14",
          "target" : "TRANSFORM7"
        },
        {
          "source" : "JOIN15",
          "target" : "TRANSFORM8"
        },
        {
          "source" : "JOIN16",
          "target" : "TRANSFORM9"
        },
        {
          "source" : "FILTER15",
          "target" : "JOIN23"
        },
        {
          "source" : "LOAD_DATASET20",
          "target" : "JOIN23"
        },
        {
          "source" : "FILTER13",
          "target" : "JOIN24"
        },
        {
          "source" : "LOAD_DATASET21",
          "target" : "JOIN24"
        },
        {
          "source" : "JOIN50",
          "target" : "JOIN25"
        },
        {
          "source" : "TRANSFORM15",
          "target" : "JOIN25"
        },
        {
          "source" : "LOAD_DATASET18",
          "target" : "AGGREGATE0"
        },
        {
          "source" : "FILTER4",
          "target" : "AGGREGATE2"
        },
        {
          "source" : "AGGREGATE2",
          "target" : "JOIN19"
        },
        {
          "source" : "TRANSFORM4",
          "target" : "AGGREGATE4"
        },
        {
          "source" : "AGGREGATE4",
          "target" : "TRANSFORM10"
        },
        {
          "source" : "TRANSFORM20",
          "target" : "AGGREGATE6"
        },
        {
          "source" : "TRANSFORM19",
          "target" : "AGGREGATE8"
        },
        {
          "source" : "TRANSFORM5",
          "target" : "AGGREGATE10"
        },
        {
          "source" : "AGGREGATE10",
          "target" : "TRANSFORM11"
        },
        {
          "source" : "LOAD_DATASET18",
          "target" : "AGGREGATE12"
        },
        {
          "source" : "FILTER4",
          "target" : "AGGREGATE14"
        },
        {
          "source" : "TRANSFORM6",
          "target" : "AGGREGATE16"
        },
        {
          "source" : "AGGREGATE16",
          "target" : "TRANSFORM12"
        },
        {
          "source" : "JOIN35",
          "target" : "JOIN29"
        },
        {
          "source" : "TRANSFORM10",
          "target" : "JOIN29"
        },
        {
          "source" : "JOIN29",
          "target" : "JOIN30"
        },
        {
          "source" : "TRANSFORM11",
          "target" : "JOIN30"
        },
        {
          "source" : "JOIN30",
          "target" : "JOIN31"
        },
        {
          "source" : "TRANSFORM12",
          "target" : "JOIN31"
        },
        {
          "source" : "JOIN24",
          "target" : "JOIN32"
        },
        {
          "source" : "TRANSFORM10",
          "target" : "JOIN32"
        },
        {
          "source" : "JOIN32",
          "target" : "JOIN33"
        },
        {
          "source" : "TRANSFORM11",
          "target" : "JOIN33"
        },
        {
          "source" : "JOIN33",
          "target" : "JOIN34"
        },
        {
          "source" : "TRANSFORM12",
          "target" : "JOIN34"
        },
        {
          "source" : "JOIN18",
          "target" : "JOIN35"
        },
        {
          "source" : "LOAD_DATASET20",
          "target" : "JOIN35"
        },
        {
          "source" : "LOAD_DATASET22",
          "target" : "AGGREGATE18"
        },
        {
          "source" : "AGGREGATE18",
          "target" : "JOIN36"
        },
        {
          "source" : "TRANSFORM7",
          "target" : "JOIN36"
        },
        {
          "source" : "JOIN36",
          "target" : "AGGREGATE20"
        },
        {
          "source" : "LOAD_DATASET22",
          "target" : "AGGREGATE22"
        },
        {
          "source" : "AGGREGATE22",
          "target" : "JOIN37"
        },
        {
          "source" : "TRANSFORM8",
          "target" : "JOIN37"
        },
        {
          "source" : "JOIN37",
          "target" : "AGGREGATE24"
        },
        {
          "source" : "LOAD_DATASET22",
          "target" : "AGGREGATE26"
        },
        {
          "source" : "AGGREGATE26",
          "target" : "JOIN38"
        },
        {
          "source" : "TRANSFORM9",
          "target" : "JOIN38"
        },
        {
          "source" : "JOIN38",
          "target" : "AGGREGATE28"
        },
        {
          "source" : "LOAD_DATASET23",
          "target" : "JOIN39"
        },
        {
          "source" : "AGGREGATE20",
          "target" : "JOIN39"
        },
        {
          "source" : "JOIN39",
          "target" : "JOIN40"
        },
        {
          "source" : "AGGREGATE24",
          "target" : "JOIN40"
        },
        {
          "source" : "JOIN40",
          "target" : "JOIN41"
        },
        {
          "source" : "AGGREGATE28",
          "target" : "JOIN41"
        },
        {
          "source" : "JOIN47",
          "target" : "TRANSFORM13"
        },
        {
          "source" : "LOAD_DATASET24",
          "target" : "JOIN42"
        },
        {
          "source" : "LOAD_DATASET25",
          "target" : "JOIN42"
        },
        {
          "source" : "JOIN42",
          "target" : "TRANSFORM14"
        },
        {
          "source" : "TRANSFORM14",
          "target" : "FILTER5"
        },
        {
          "source" : "TRANSFORM14",
          "target" : "FILTER6"
        },
        {
          "source" : "TRANSFORM14",
          "target" : "FILTER7"
        },
        {
          "source" : "TRANSFORM14",
          "target" : "FILTER8"
        },
        {
          "source" : "TRANSFORM14",
          "target" : "FILTER9"
        },
        {
          "source" : "JOIN48",
          "target" : "JOIN43"
        },
        {
          "source" : "FILTER5",
          "target" : "JOIN43"
        },
        {
          "source" : "JOIN43",
          "target" : "JOIN44"
        },
        {
          "source" : "FILTER6",
          "target" : "JOIN44"
        },
        {
          "source" : "JOIN44",
          "target" : "JOIN45"
        },
        {
          "source" : "FILTER7",
          "target" : "JOIN45"
        },
        {
          "source" : "JOIN45",
          "target" : "JOIN46"
        },
        {
          "source" : "FILTER8",
          "target" : "JOIN46"
        },
        {
          "source" : "JOIN46",
          "target" : "JOIN47"
        },
        {
          "source" : "FILTER9",
          "target" : "JOIN47"
        },
        {
          "source" : "JOIN41",
          "target" : "JOIN48"
        },
        {
          "source" : "LOAD_DATASET26",
          "target" : "JOIN48"
        },
        {
          "source" : "JOIN31",
          "target" : "JOIN49"
        },
        {
          "source" : "TRANSFORM13",
          "target" : "JOIN49"
        },
        {
          "source" : "JOIN34",
          "target" : "JOIN50"
        },
        {
          "source" : "TRANSFORM13",
          "target" : "JOIN50"
        },
        {
          "source" : "JOIN52",
          "target" : "TRANSFORM15"
        },
        {
          "source" : "LOAD_DATASET27",
          "target" : "TRANSFORM16"
        },
        {
          "source" : "TRANSFORM16",
          "target" : "AGGREGATE30"
        },
        {
          "source" : "LOAD_DATASET28",
          "target" : "JOIN51"
        },
        {
          "source" : "AGGREGATE30",
          "target" : "JOIN51"
        },
        {
          "source" : "JOIN51",
          "target" : "FILTER10"
        },
        {
          "source" : "JOIN54",
          "target" : "JOIN52"
        },
        {
          "source" : "FILTER10",
          "target" : "JOIN52"
        },
        {
          "source" : "JOIN10",
          "target" : "JOIN53"
        },
        {
          "source" : "LOAD_DATASET29",
          "target" : "JOIN53"
        },
        {
          "source" : "JOIN53",
          "target" : "JOIN54"
        },
        {
          "source" : "LOAD_DATASET30",
          "target" : "JOIN54"
        },
        {
          "source" : "TRANSFORM18",
          "target" : "APPEND0"
        },
        {
          "source" : "TRANSFORM17",
          "target" : "APPEND0"
        },
        {
          "source" : "JOIN25",
          "target" : "TRANSFORM17"
        },
        {
          "source" : "JOIN22",
          "target" : "TRANSFORM18"
        },
        {
          "source" : "APPEND0",
          "target" : "FILTER11"
        },
        {
          "source" : "TRANSFORM3",
          "target" : "FILTER12"
        },
        {
          "source" : "JOIN23",
          "target" : "JOIN55"
        },
        {
          "source" : "FILTER12",
          "target" : "JOIN55"
        },
        {
          "source" : "JOIN55",
          "target" : "FILTER13"
        },
        {
          "source" : "LOAD_DATASET16",
          "target" : "JOIN56"
        },
        {
          "source" : "LOAD_DATASET31",
          "target" : "JOIN56"
        },
        {
          "source" : "JOIN56",
          "target" : "FILTER14"
        },
        {
          "source" : "LOAD_DATASET19",
          "target" : "FILTER15"
        },
        {
          "source" : "FILTER11",
          "target" : "DISCOVERY_PREDICT0"
        },
        {
          "source" : "DISCOVERY_PREDICT0",
          "target" : "OUTPUT0"
        },
        {
          "source" : "LOAD_DATASET15",
          "target" : "JOIN57"
        },
        {
          "source" : "LOAD_DATASET32",
          "target" : "JOIN57"
        },
        {
          "source" : "FILTER4",
          "target" : "TRANSFORM19"
        },
        {
          "source" : "LOAD_DATASET18",
          "target" : "TRANSFORM20"
        }
      ],
      "hiddenColumns" : [ ]
    }
  }
}